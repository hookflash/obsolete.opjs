
                (function($) {
            (function(){function k(a){throw a;}var m=void 0,p=!0,r=null,s=!1;function aa(){return function(){}}function u(a){return function(){return this[a]}}function ba(a){return function(){return a}}var x,y=this;function ca(a){a=a.split(".");for(var b=y,c;c=a.shift();)if(b[c]!=r)b=b[c];else return r;return b}
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function z(a){return a!==m}function A(a){return"array"==da(a)}function B(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function C(a){return"string"==typeof a}function fa(a){return"boolean"==typeof a}function F(a){return"number"==typeof a}function ga(a){return"function"==da(a)}function G(a){var b=typeof a;return"object"==b&&a!=r||"function"==b}function ha(a){return a[ia]||(a[ia]=++ja)}
var ia="closure_uid_"+(1E9*Math.random()>>>0),ja=0;function ka(a,b,c){return a.call.apply(a.bind,arguments)}function la(a,b,c){a||k(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ma(a,b,c){ma=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ka:la;return ma.apply(r,arguments)}function na(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var oa=Date.now||function(){return+new Date};
function H(a,b){var c=a.split("."),d=y;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&z(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function I(a,b){function c(){}c.prototype=b.prototype;a.D=b.prototype;a.prototype=new c};function qa(a){Error.captureStackTrace?Error.captureStackTrace(this,qa):this.stack=Error().stack||"";a&&(this.message=String(a))}I(qa,Error);qa.prototype.name="CustomError";function ra(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function sa(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function ta(a){if(!va.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(wa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(xa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(ya,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(za,"&quot;"));return a}var wa=/&/g,xa=/</g,ya=/>/g,za=/\"/g,va=/[&<>\"]/;
function Aa(a){return sa(a.replace(/  /g," &#160;"),m)}function Ba(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ca={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Da={"'":"\\'"};
function Ea(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,h;if(!(h=Ca[d])){if(!(31<e&&127>e))if(d in Da)d=Da[d];else if(d in Ca)d=Da[d]=Ca[d];else{e=d;h=d.charCodeAt(0);if(31<h&&127>h)e=d;else{if(256>h){if(e="\\x",16>h||256<h)e+="0"}else e="\\u",4096>h&&(e+="0");e+=h.toString(16).toUpperCase()}d=Da[d]=e}h=d}f[g]=h}b.push('"');return b.join("")};function Fa(a,b){b.unshift(a);qa.call(this,ra.apply(r,b));b.shift()}I(Fa,qa);Fa.prototype.name="AssertionError";function Ga(a,b){k(new Fa("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};var Ha=Array.prototype,Ia=Ha.indexOf?function(a,b,c){return Ha.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(C(a))return!C(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ja=Ha.forEach?function(a,b,c){Ha.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=C(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ka=Ha.map?function(a,b,c){return Ha.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=C(a)?
a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};function La(a,b){if(a.reduce)return a.reduce(b,0);var c=0;Ja(a,function(d,e){c=b.call(m,c,d,e,a)});return c}var Ma=Ha.some?function(a,b,c){return Ha.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=C(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return s};function Oa(a,b){var c=Pa(a,b,m);return 0>c?r:C(a)?a.charAt(c):a[c]}
function Pa(a,b,c){for(var d=a.length,e=C(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Qa(a){if(!A(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Ra(a,b){var c=Ia(a,b),d;(d=0<=c)&&Ha.splice.call(a,c,1);return d}function Sa(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Ta(a,b,c){return 2>=arguments.length?Ha.slice.call(a,b):Ha.slice.call(a,b,c)}
function Ua(a,b){if(!B(a)||!B(b)||a.length!=b.length)return s;for(var c=a.length,d=Va,e=0;e<c;e++)if(!d(a[e],b[e]))return s;return p}function Va(a,b){return a===b};function Wa(a,b){for(var c in a)b.call(m,a[c],c,a)}function Xa(a,b){for(var c=B(b),d=c?b:arguments,c=c?0:1;c<d.length&&!(a=a[d[c]],!z(a));c++);return a}var Ya="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Za(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Ya.length;f++)c=Ya[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var $a="StopIteration"in y?y.StopIteration:Error("StopIteration");function ab(){}ab.prototype.a=function(){k($a)};ab.prototype.ma=function(){return this};function bb(a){if(a instanceof ab)return a;if("function"==typeof a.ma)return a.ma(s);if(B(a)){var b=0,c=new ab;c.a=function(){for(;;){b>=a.length&&k($a);if(b in a)return a[b++];b++}};return c}k(Error("Not implemented"))}
function cb(a,b,c){if(B(a))try{Ja(a,b,c)}catch(d){d!==$a&&k(d)}else{a=bb(a);try{for(;;)b.call(c,a.a(),m,a)}catch(e){e!==$a&&k(e)}}}function db(a){if(B(a))return Sa(a);a=bb(a);var b=[];cb(a,function(a){b.push(a)});return b};function eb(a,b){this.c={};this.a=[];var c=arguments.length;if(1<c){c%2&&k(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)fb(this,arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof eb)e=a.ea(),d=a.ab();else{var c=[],f=0;for(e in a)c[f++]=e;e=c;c=[];f=0;for(d in a)c[f++]=a[d];d=c}for(c=0;c<e.length;c++)fb(this,e[c],d[c])}}x=eb.prototype;x.p=0;x.bb=0;x.Ca=u("p");x.ab=function(){gb(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.c[this.a[b]]);return a};
x.ea=function(){gb(this);return this.a.concat()};x.clear=function(){this.c={};this.bb=this.p=this.a.length=0};function gb(a){if(a.p!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Object.prototype.hasOwnProperty.call(a.c,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.p!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Object.prototype.hasOwnProperty.call(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}
function fb(a,b,c){Object.prototype.hasOwnProperty.call(a.c,b)||(a.p++,a.a.push(b),a.bb++);a.c[b]=c}x.Ba=function(){return new eb(this)};x.ma=function(a){gb(this);var b=0,c=this.a,d=this.c,e=this.bb,f=this,g=new ab;g.a=function(){for(;;){e!=f.bb&&k(Error("The map has changed since the iterator was created"));b>=c.length&&k($a);var g=c[b++];return a?g:d[g]}};return g};var hb,ib,jb,kb;function lb(){return y.navigator?y.navigator.userAgent:r}kb=jb=ib=hb=s;var mb;if(mb=lb()){var nb=y.navigator;hb=0==mb.indexOf("Opera");ib=!hb&&-1!=mb.indexOf("MSIE");jb=!hb&&-1!=mb.indexOf("WebKit");kb=!hb&&!jb&&"Gecko"==nb.product}var ob=hb,pb=ib,qb=kb,rb=jb;function sb(){var a=y.document;return a?a.documentMode:m}var tb;
a:{var ub="",vb;if(ob&&y.opera)var wb=y.opera.version,ub="function"==typeof wb?wb():wb;else if(qb?vb=/rv\:([^\);]+)(\)|;)/:pb?vb=/MSIE\s+([^\);]+)(\)|;)/:rb&&(vb=/WebKit\/(\S+)/),vb)var xb=vb.exec(lb()),ub=xb?xb[1]:"";if(pb){var yb=sb();if(yb>parseFloat(ub)){tb=String(yb);break a}}tb=ub}var zb={};
function Ab(a){var b;if(!(b=zb[a])){b=0;for(var c=String(tb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=/(\d*)(\D*)/g,n=/(\d*)(\D*)/g;do{var q=l.exec(g)||["","",""],t=n.exec(h)||["","",""];if(0==q[0].length&&0==t[0].length)break;b=((0==q[1].length?0:parseInt(q[1],10))<(0==t[1].length?0:parseInt(t[1],10))?-1:(0==q[1].length?0:parseInt(q[1],10))>(0==t[1].length?
0:parseInt(t[1],10))?1:0)||((0==q[2].length)<(0==t[2].length)?-1:(0==q[2].length)>(0==t[2].length)?1:0)||(q[2]<t[2]?-1:q[2]>t[2]?1:0)}while(0==b)}b=zb[a]=0<=b}return b}var Bb=y.document,Cb=!Bb||!pb?m:sb()||("CSS1Compat"==Bb.compatMode?parseInt(tb,10):5);function Db(a){return Fb(a||arguments.callee.caller,[])}
function Fb(a,b){var c=[];if(0<=Ia(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Hb(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Hb(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Fb(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Hb(a){if(Ib[a])return Ib[a];a=String(a);if(!Ib[a]){var b=/function ([^\(]+)/.exec(a);Ib[a]=b?b[1]:"[Anonymous]"}return Ib[a]}var Ib={};function Jb(a,b,c,d,e){"number"==typeof e||Kb++;this.g=d||oa();this.f=a;this.e=b;this.d=c;delete this.c;delete this.a}Jb.prototype.c=r;Jb.prototype.a=r;var Kb=0;function Lb(a){this.f=a}Lb.prototype.d=r;Lb.prototype.c=r;Lb.prototype.e=r;Lb.prototype.a=r;function Mb(a,b){this.name=a;this.value=b}Mb.prototype.toString=u("name");var Nb=new Mb("SHOUT",1200),Ob=new Mb("SEVERE",1E3),Pb=new Mb("WARNING",900),Qb=new Mb("INFO",800),Rb=new Mb("CONFIG",700),Sb=new Mb("FINE",500),Tb=new Mb("FINER",400),Ub=new Mb("FINEST",300),Vb=[new Mb("OFF",Infinity),Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,new Mb("ALL",0)],Wb=r;Lb.prototype.getName=u("f");
function Xb(a){if(a.c)return a.c;if(a.d)return Xb(a.d);Ga("Root logger has no level set.");return r}Lb.prototype.log=function(a,b,c){if(a.value>=Xb(this).value){a=this.g(a,b,c);b="log:"+a.e;y.console&&(y.console.timeStamp?y.console.timeStamp(b):y.console.markTimeline&&y.console.markTimeline(b));y.msWriteProfilerMark&&y.msWriteProfilerMark(b);for(b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=m;f=c.a[e];e++)f(d);b=b.d}}};
Lb.prototype.g=function(a,b,c){var d=new Jb(a,String(b),this.f);if(c){d.c=c;var e;var f=arguments.callee.caller;try{var g;var h=ca("window.location.href");if(C(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:h,stack:"Not available"};else{var l,n,q=s;try{l=c.lineNumber||c.Uc||"Not available"}catch(t){l="Not available",q=p}try{n=c.fileName||c.filename||c.sourceURL||y.$googDebugFname||h}catch(w){n="Not available",q=p}g=q||!c.lineNumber||!c.fileName||!c.stack?{message:c.message,
name:c.name,lineNumber:l,fileName:n,stack:c.stack||"Not available"}:c}e="Message: "+ta(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+ta(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+ta(Db(f)+"-> ")}catch(v){e="Exception trying to expose exception! You win, we lose. "+v}d.a=e}return d};function Yb(a,b){a.log(Ob,b,m)}function J(a,b){a.log(Pb,b,m)}function Zb(a,b){a.log(Sb,b,m)}function K(a,b){a.log(Tb,b,m)}
function L(a,b){a.log(Ub,b,m)}var ac={},bc=r;function cc(){bc||(bc=new Lb(""),ac[""]=bc,bc.c=Rb)}function dc(){cc();return bc}function M(a){cc();var b;if(!(b=ac[a])){b=new Lb(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=M(a.substr(0,c));c.e||(c.e={});c.e[d]=b;b.d=c;ac[a]=b}return b};function ec(a){return function(){k(a)}};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function N(a,b){this.d=[];this.Ga=a;this.j=b||r}x=N.prototype;x.W=s;x.Da=s;x.wb=s;x.qc=s;x.Nb=s;x.xb=0;function fc(a,b){if(a.W)a.c instanceof N&&fc(a.c);else{if(a.a){var c=a.a;delete a.a;b?fc(c,b):(c.xb--,0>=c.xb&&fc(c))}a.Ga?a.Ga.call(a.j,a):a.Nb=p;a.W||a.n(new gc)}}x.Xb=function(a,b){this.wb=s;hc(this,a,b)};function hc(a,b,c){a.W=p;a.c=c;a.Da=!b;ic(a)}function jc(a){a.W&&(a.Nb||k(new kc),a.Nb=s)}function O(a,b){jc(a);hc(a,p,b)}x.n=function(a){jc(this);hc(this,s,a)};
x.U=function(a,b){return this.z(a,r,b)};x.Vb=function(a,b){return this.z(r,a,b)};x.pc=function(a,b){return this.z(a,a,b)};x.z=function(a,b,c){this.d.push([a,b,c]);this.W&&ic(this);return this};function lc(a){return Ma(a.d,function(a){return ga(a[1])})}
function ic(a){a.g&&(a.W&&lc(a))&&(y.clearTimeout(a.g),delete a.g);a.a&&(a.a.xb--,delete a.a);for(var b=a.c,c=s,d=s;a.d.length&&!a.wb;){var e=a.d.shift(),f=e[0],g=e[1],e=e[2];if(f=a.Da?g:f)try{var h=f.call(e||a.j,b);z(h)&&(a.Da=a.Da&&(h==b||h instanceof Error),a.c=b=h);b instanceof N&&(d=p,a.wb=p)}catch(l){b=l,a.Da=p,lc(a)||(c=p)}}a.c=b;d&&(b.z(ma(a.Xb,a,p),ma(a.Xb,a,s)),b.qc=p);c&&(a.g=y.setTimeout(ec(b),0))}function mc(a){var b=new N;O(b,a);return b}
function nc(a){Error.captureStackTrace?Error.captureStackTrace(this,nc):this.stack=Error().stack||"";a&&(this.message=String(a))}I(nc,Error);function kc(){nc.call(this)}I(kc,nc);kc.prototype.message="Deferred has already fired";kc.prototype.name="AlreadyCalledError";function gc(){nc.call(this)}I(gc,nc);gc.prototype.message="Deferred was canceled";gc.prototype.name="CanceledError";function oc(){return new N}var pc={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},qc=y.IDBRequest&&"LOADING"in y.IDBRequest?y.IDBTransaction:y.webkitIDBRequest&&"LOADING"in y.webkitIDBRequest&&1===y.webkitIDBTransaction.READ_WRITE?y.webkitIDBTransaction:pc,P=qc.READ_ONLY,Q=qc.READ_WRITE,rc=qc.VERSION_CHANGE;function sc(a,b){return a?b?"prevunique":"prev":b?"nextunique":"next"};function tc(a,b){var c,d;2==arguments.length&&C(arguments[1])?(c=p,d=arguments[1].split(".")):d=(c=B(b))?b:arguments;for(c=c?0:1;c<d.length&&!(a=a[d[c]],!z(a));c++);return a}var uc={};
function vc(a){var b=[a];a=new wc;for(var c=0,d,e;(e=b.pop())!==m;){0===c%4&&12<c+4&&(a.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){b.push(uc);for(d=e.length;d--;)b.push(e[d]);continue}else a.write(c);else if("number"===d)c+=1,a.write(c),xc(a,e);else if(e instanceof Date)c+=2,a.write(c),xc(a,e.valueOf());else if("string"===d){c+=3;a.write(c);c=a;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>2|
255,(f|3)<<6)}c.write(0)}else if(e===uc)a.write(0);else return"";c=0}for(b=a.a.length;"00"===a.a[--b];);a.a.length=++b;return a.toString()}function yc(a){for(var b=[],c=b,d=[],e,f,g=new zc(a);Ac(g)!=r;)if(0===g.a)c=d.pop();else{if(g.a===r)break;do{e=g.a/4|0;a=g.a%4;for(var h=0;h<e;h++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.a+4)Ac(g);else break}while(1);1===a?c.push(Bc(g)):2===a?c.push(new Date(Bc(g))):3===a?c.push(Cc(g)):0===a&&(c=d.pop())}return b[0]}
function xc(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Bc(a){var b=Ac(a)|0,c=b>>7?s:p,d=c?-1:1,e=(b&127)<<4,b=Ac(a)|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(Ac(a)|0):Ac(a)|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Cc(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=Ac(a);if(0===f||f==r)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function zc(a){this.a=r;this.c=a;this.d=this.c.length-1;this.index=-1}function Ac(a){return a.a=a.index<a.d?parseInt(a.c[++a.index]+a.c[++a.index],16):r}function wc(){this.a=[];this.c=m}
wc.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.c=arguments[b].toString(16),this.a.push(2===this.c.length?this.c:this.c="0"+this.c)};wc.prototype.toString=function(){return this.a.length?this.a.join(""):""};function Dc(a,b){var c=vc(a),d=vc(b);return c>d?1:c==d?0:-1};function Ec(){0!=Fc&&(Gc[ha(this)]=this)}var Fc=0,Gc={};Ec.prototype.Ga=s;Ec.prototype.X=function(){if(!this.Ga&&(this.Ga=p,this.ra(),0!=Fc)){var a=ha(this);delete Gc[a]}};Ec.prototype.ra=function(){if(this.gb)for(;this.gb.length;)this.gb.shift()()};var Hc=!pb||pb&&9<=Cb,Ic=pb&&!Ab("9");!rb||Ab("528");qb&&Ab("1.9b")||pb&&Ab("8")||ob&&Ab("9.5")||rb&&Ab("528");qb&&!Ab("8")||pb&&Ab("9");function Jc(a,b){this.type=a;this.a=this.target=b}Jc.prototype.X=aa();Jc.prototype.c=s;Jc.prototype.e=p;Jc.prototype.Bb=function(){this.e=s};function Kc(a){Kc[" "](a);return a}Kc[" "]=aa();function Lc(a,b){a&&Mc(this,a,b)}I(Lc,Jc);x=Lc.prototype;x.target=r;x.clientX=0;x.clientY=0;x.Yb=r;function Mc(a,b,c){var d=a.type=b.type;Jc.call(a,d);a.target=b.target||b.srcElement;a.a=c;if((c=b.relatedTarget)&&qb)try{Kc(c.nodeName)}catch(e){}a.clientX=b.clientX!==m?b.clientX:b.pageX;a.clientY=b.clientY!==m?b.clientY:b.pageY;a.Yb=b;b.defaultPrevented&&a.Bb();delete a.c}
x.Bb=function(){Lc.D.Bb.call(this);var a=this.Yb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,Ic)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var Nc="closure_listenable_"+(1E6*Math.random()|0),Oc=0;function Pc(a,b,c,d,e,f){this.ga=a;this.a=b;this.src=c;this.type=d;this.capture=!!e;this.cb=f;this.key=++Oc;this.K=this.na=s}Pc.prototype.handleEvent=function(a){return this.ga.call(this.cb||this.src,a)};var Qc={},Rc={},Sc={},Tc={};
function Uc(a,b,c,d,e){if(A(b))for(var f=0;f<b.length;f++)Uc(a,b[f],c,d,e);else if(c=Vc(c),a&&a[Nc]){f=c;c=a.f[b]||(a.f[b]=[]);var g=Wc(c,f,d,e);-1<g?(a=c[g],a.na=s):(a=new Pc(f,r,a,b,!!d,e),a.na=s,c.push(a))}else a:{b||k(Error("Invalid event type"));d=!!d;var h=Rc;b in h||(h[b]={p:0,Q:0});h=h[b];d in h||(h[d]={p:0,Q:0},h.p++);h=h[d];f=ha(a);h.Q++;if(h[f])for(var g=h[f],l=0;l<g.length;l++){if(h=g[l],h.ga==c&&h.cb==e){if(h.K)break;g[l].na=s;break a}}else g=h[f]=[],h.p++;l=Xc();h=new Pc(c,l,a,b,d,e);
h.na=s;l.src=a;l.ga=h;g.push(h);Sc[f]||(Sc[f]=[]);Sc[f].push(h);a.addEventListener?a.addEventListener(b,l,d):a.attachEvent(b in Tc?Tc[b]:Tc[b]="on"+b,l);Qc[h.key]=h}}function Xc(){var a=Yc,b=Hc?function(c){return a.call(b.src,b.ga,c)}:function(c){c=a.call(b.src,b.ga,c);if(!c)return c};return b}
function Zc(a,b,c,d,e){if(A(b))for(var f=0;f<b.length;f++)Zc(a,b[f],c,d,e);else if(c=Vc(c),a&&a[Nc])b in a.f&&(a=a.f[b],c=Wc(a,c,d,e),-1<c&&(e=a[c],delete Qc[e.key],e.K=p,Ha.splice.call(a,c,1)));else{d=!!d;a:{f=Rc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ha(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].ga==c&&a[f].capture==d&&a[f].cb==e){$c(a[f]);break}}}
function $c(a){if(!F(a)&&a&&!a.K){var b=a.src;if(b&&b[Nc])ad(b,a);else{var c=a.type,d=a.a,e=a.capture;b.removeEventListener?b.removeEventListener(c,d,e):b.detachEvent&&b.detachEvent(c in Tc?Tc[c]:Tc[c]="on"+c,d);b=ha(b);Sc[b]&&(d=Sc[b],Ra(d,a),0==d.length&&delete Sc[b]);a.K=p;if(d=Rc[c][e][b])d.cc=p,bd(c,e,b,d);delete Qc[a.key]}}}
function bd(a,b,c,d){if(!d.hb&&d.cc){for(var e=0,f=0;e<d.length;e++)d[e].K?d[e].a.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.cc=s;0==f&&(delete Rc[a][b][c],Rc[a][b].p--,0==Rc[a][b].p&&(delete Rc[a][b],Rc[a].p--),0==Rc[a].p&&delete Rc[a])}}function cd(a,b,c,d,e){var f=1;b=ha(b);if(a[b]){var g=--a.Q,h=a[b];h.hb?h.hb++:h.hb=1;try{for(var l=h.length,n=0;n<l;n++){var q=h[n];q&&!q.K&&(f&=dd(q,e)!==s)}}finally{a.Q=Math.max(g,a.Q),h.hb--,bd(c,d,b,h)}}return Boolean(f)}
function dd(a,b){a.na&&$c(a);return a.handleEvent(b)}
function Yc(a,b){if(a.K)return p;var c=a.type,d=Rc;if(!(c in d))return p;var d=d[c],e,f;if(!Hc){e=b||ca("window.event");var g=p in d,h=s in d;if(g){if(0>e.keyCode||e.returnValue!=m)return p;a:{var l=s;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(n){l=p}if(l||e.returnValue==m)e.returnValue=p}}l=new Lc;Mc(l,e,this);e=p;try{if(g){for(var q=[],t=l.a;t;t=t.parentNode)q.push(t);f=d[p];f.Q=f.p;for(var w=q.length-1;!l.c&&0<=w&&f.Q;w--)l.a=q[w],e&=cd(f,q[w],c,p,l);if(h){f=d[s];f.Q=f.p;for(w=0;!l.c&&w<q.length&&
f.Q;w++)l.a=q[w],e&=cd(f,q[w],c,s,l)}}else e=dd(a,l)}finally{q&&(q.length=0)}return e}c=new Lc(b,this);return e=dd(a,c)}var ed="__closure_events_fn_"+(1E9*Math.random()>>>0);function Vc(a){return ga(a)?a:a[ed]||(a[ed]=function(b){return a.handleEvent(b)})};function fd(){Ec.call(this);this.f={};this.vc=this}I(fd,Ec);fd.prototype[Nc]=p;fd.prototype.k=r;fd.prototype.Ab=function(a,b,c,d){Uc(this,a,b,c,d)};fd.prototype.removeEventListener=function(a,b,c,d){Zc(this,a,b,c,d)};
function gd(a,b){var c,d=a.k;if(d)for(c=[];d;d=d.k)c.push(d);var d=a.vc,e=b,f=e.type||e;if(C(e))e=new Jc(e,d);else if(e instanceof Jc)e.target=e.target||d;else{var g=e,e=new Jc(f,d);Za(e,g)}var g=p,h;if(c)for(var l=c.length-1;!e.c&&0<=l;l--)h=e.a=c[l],g=hd(h,f,p,e)&&g;e.c||(h=e.a=d,g=hd(h,f,p,e)&&g,e.c||(g=hd(h,f,s,e)&&g));if(c)for(l=0;!e.c&&l<c.length;l++)h=e.a=c[l],g=hd(h,f,s,e)&&g}
fd.prototype.ra=function(){fd.D.ra.call(this);var a=0,b;for(b in this.f){for(var c=this.f[b],d=0;d<c.length;d++)++a,delete Qc[c[d].key],c[d].K=p;c.length=0}this.k=r};function ad(a,b){var c=b.type;c in a.f&&Ra(a.f[c],b)&&(delete Qc[b.key],b.K=p)}function hd(a,b,c,d){if(!(b in a.f))return p;var e=p;b=Sa(a.f[b]);for(var f=0;f<b.length;++f){var g=b[f];g&&(!g.K&&g.capture==c)&&(g.na&&ad(a,g),e=g.handleEvent(d)!==s&&e)}return e&&d.e!=s}
function Wc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(f.ga==b&&f.capture==!!c&&f.cb==d)return e}return-1};function id(a,b,c){ga(a)?c&&(a=ma(a,c)):a&&"function"==typeof a.handleEvent?a=ma(a.handleEvent,a):k(Error("Invalid listener argument"));2147483647<b||y.setTimeout(a,b||0)};function jd(a,b,c,d,e,f){N.call(this,e,f);this.f=a;this.e=[];this.k=!!b;this.ua=!!c;this.gb=!!d;for(b=this.X=0;b<a.length;b++)a[b].z(ma(this.r,this,b,p),ma(this.r,this,b,s));0==a.length&&!this.k&&O(this,this.e)}I(jd,N);jd.prototype.r=function(a,b,c){this.X++;this.e[a]=[b,c];this.W||(this.k&&b?O(this,[a,c]):this.ua&&!b?this.n(c):this.X==this.f.length&&O(this,this.e));this.gb&&!b&&(c=r);return c};jd.prototype.n=function(a){jd.D.n.call(this,a);for(a=0;a<this.f.length;a++)fc(this.f[a])};H("ydn.async.all",function(a){for(var b=[],c,d=0;c=a[d];d++){var e=new N;c.success(na(function(a,b){O(a,b)},e));c.error(na(function(a,b){a.n(b)},e));b[d]=e}return new jd(b)});function kd(a,b,c){var d;G(a)?(d=a.store,b=a.id,a.parent!=r&&(c=new kd(a.parent))):z(b)?d=a:(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new kd(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],z(b)||k(Error("Invalid key value: "+a)));this.a=d;this.id=b;this.parent=c||r}x=kd.prototype;x.toJSON=function(){var a={store:this.a,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};x.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.a+"^:"+this.id};
x.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};x.Lc=u("a");x.rc=u("id");x.Kc=u("parent");function ld(a){if(B(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function R(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ga(Object.freeze)&&Object.freeze(this)}R.prototype.lower=m;R.prototype.upper=m;R.prototype.toJSON=function(){return md(this)};function nd(a,b,c,d){return new R(a,b,c,d)}function od(a,b){return new R(m,a,m,!!b)}function pd(a,b){return new R(a,m,!!b,m)}function qd(a){var b;A(a)?(b=Sa(a),b.push("\uffff")):C(a)?b=a+"\uffff":k(new S);return nd(a,b,s,p)}
function md(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function rd(a){return a!=r?a.upper!=r&&a.lower!=r?sd.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):a.upper!=r?sd.upperBound(a.upper,a.upperOpen):a.lower!=r?sd.lowerBound(a.lower,a.lowerOpen):r:r}
function td(a){if(a instanceof R)return"";if(a!=r){if(G(a)){for(var b in a)if(a.hasOwnProperty(b)&&!(0<=Ia(["lower","upper","lowerOpen","upperOpen"],b)))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
R.prototype.vb=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;if(a.lower!=r&&(this.lower==r||a.lower>=this.lower))b=a.lower,d=a.lowerOpen||this.lowerOpen;if(a.upper!=r&&(this.upper==r||a.upper<=this.upper))c=a.upper,e=a.upperOpen||this.upperOpen;return nd(b,c,d,e)};
function ud(a,b,c,d,e){if(c)if(!c.lowerOpen&&!c.upperOpen&&c.lower!=r&&c.upper!=r&&0===V(c.lower,c.upper))d.push(a+" = ?"),e.push(vd(c.lower,b));else{if(c.lower!=r){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(vd(c.lower,b))}c.upper!=r&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(vd(c.upper,b)))}}
function wd(a,b,c,d){var e,f,g,h;if("^"==a)return qd(b);"<"==a||"<="==a?(e=b,g="<"==a):">"==a||">="==a?(f=b,h=">"==a):"="==a||"=="==a?e=f=b:k(new S("invalid op: "+a));"<"==c||"<="==c?(e=d,g="<"==c):">"==c||">="==c?(f=d,h=">"==c):z(c)&&k(new S("invalid op2: "+c));return nd(f,e,h,g)}var sd=y.IDBKeyRange||y.webkitIDBKeyRange||R;function S(a){qa.call(this,a);this.name="ydn.error.ArgumentException"}I(S,qa);function xd(a){qa.call(this,a);this.name="ydn.error.InvalidOperationException"}I(xd,qa);function yd(a){Error.captureStackTrace?Error.captureStackTrace(this,yd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}I(yd,Error);yd.prototype.name="ydn.error.InternalError";function zd(a,b,c,d,e){z(e)||(e=A(a)?a.join(", "):a);a!=r&&(!C(a)&&!B(a))&&k(new S("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a));A(a)&&Object.freeze&&Object.freeze(a);!z(a)&&z(e)&&(a=e);this.keyPath=a;this.e=B(this.keyPath);this.name=e;this.type=Ad(b);z(b)&&(z(this.type)||k(new S("type invalid in index: "+this.name)),A(this.keyPath)&&k(new S('composite key for store "'+this.name+'" must not specified type')));this.unique=!!c;this.multiEntry=!!d;this.f=C(this.type)?
this.type:Bd;this.c=C(e)?e:A(a)?this.keyPath.join(","):a;this.a=Ea(this.c);this.d=!this.e&&!this.multiEntry?this.keyPath.split("."):r}function Cd(a,b){if(b!=r){if(B(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=tc(b,a.keyPath[d]);c[d]=f}return c}return tc(b,a.keyPath)}}function Dd(a,b,c){for(var d=0;d<a.d.length;d++)d==a.d.length-1?b[a.d[d]]=c:G(b[a.d[d]])||(b[a.d[d]]={})}var Bd="TEXT";function vd(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return z(b)?a:vc(a)}
function Ed(a,b){return"DATE"==b?new Date(a):z(b)?a:yc(a)}var Fd=["BLOB","DATE","INTEGER","NUMERIC",Bd];function Ad(a){if(C(a))return a=Ia(Fd,a),Fd[a]}zd.prototype.getName=u("name");zd.prototype.toJSON=function(){return{name:this.name,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};zd.prototype.Ba=function(){var a=A(this.keyPath)?Sa(this.keyPath):this.keyPath;return new zd(a,this.type,this.unique,this.multiEntry,this.name)};
function Gd(a,b){return a==r&&b==r?r:a!=r?b!=r?B(a)&&B(b)?Ua(a,b)?r:"expect: "+a+", but: "+b:Hd(a,b)?r:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b}zd.prototype.hint=function(a){if(!a)return this;var b=A(this.keyPath)?Sa(this.keyPath):this.keyPath,c=this.type;!z(a.type)&&"TEXT"==c&&(c=m);return new zd(b,c,this.unique,this.multiEntry,a.name)};function Id(a,b,c,d,e,f,g){this.name=a;C(this.name)||k(new S("store name must be a string"));this.keyPath=z(b)?b:r;this.e=B(this.keyPath);this.keyPath!==r&&(!C(this.keyPath)&&!this.e)&&k(new S("keyPath must be a string or array"));this.autoIncrement=c;var h;d!=r&&(h=Ad(d),z(h)||k(new S('type "'+d+'" for primary key in store "'+this.name+'" is invalid.')),this.e&&k(new S('composite key for store "'+this.name+'" must not specified type')));this.type=h!=r?h:this.autoIncrement?"INTEGER":m;this.d=C(this.keyPath)?
this.keyPath.split("."):[];this.indexes=e||[];this.da=!!f;this.lc=!!g;this.f=C(this.type)?this.type:Bd;this.c=A(this.keyPath)?this.keyPath.join(","):C(this.keyPath)?this.keyPath:"_ROWID_";this.a=Ea(this.c)}x=Id.prototype;x.da=s;x.lc=s;x.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.name,keyPath:this.keyPath,autoIncrement:this.autoIncrement,type:this.type,indexes:a}};
function Jd(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync".split(" "),c;for(c in a)a.hasOwnProperty(c)&&-1==Ia(b,c)&&k(new S('Unknown attribute "'+c+'"'));b=[];c=a.indexes||[];if(A(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f=["name","unique","type","keyPath","multiEntry"],g=m;for(g in e)e.hasOwnProperty(g)&&-1==Ia(f,g)&&k(new S("Unknown field: "+g+" in "+W(e)));e=new zd(e.keyPath,e.type,e.unique,e.multiEntry,e.name);z(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new Id(a.name,
a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?m:a.type,b,a.dispatchEvents,a.fixed)}function Kd(a,b,c,d,e,f,g){a=Ld(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.qa;a.m&&(b+=" WHERE "+a.m);a.group&&(b+=" GROUP BY "+a.group);a.Y&&(b+=" ORDER BY "+a.Y);return b}
function Ld(a,b,c,d,e,f,g){var h={select:"",qa:"",m:"",group:"",Y:""},l=a.c,n=a.a,q=r;d!==l&&C(d)&&(q=Md(a,d));var t=!!q,w=d||l,v=Ea(w),D=t?q.type:a.type,E=t&&q.multiEntry;h.qa=Nd(a);3===c?h.select="COUNT("+n+")":1===c?(h.select=n,d!=r&&d!=l&&(h.select+=", "+v)):h.select="*";d=g?"DISTINCT ":"";l=[];E?(E=Ea("ydn.db.me:"+a.getName()+":"+q.getName()),h.select=3===c?"COUNT("+d+E+"."+v+")":1===c?Nd(a)+"."+n+", "+E+"."+v:Nd(a)+".*, "+E+"."+v+" AS "+w,h.qa=E+" INNER JOIN "+Nd(a)+" USING ("+n+")",e!=r&&(ud(E+
"."+v,D,e,l,b),0<l.length&&(h.m=h.m?h.m+(" AND "+l.join(" AND ")):l.join(" AND ")))):e!=r&&(ud(v,D,e,l,b),0<l.length&&(h.m=h.m?h.m+(" AND "+l.join(" AND ")):l.join(" AND ")));t&&(!q.unique&&g)&&(h.group=v);a=f?"DESC":"ASC";h.Y=v+" "+a;t&&(h.Y+=", "+n+" "+a);return h}x.Ba=function(){return Jd(this.toJSON())};x.index=function(a){return this.indexes[a]||r};function Md(a,b){return Oa(a.indexes,function(a){return a.name==b})}
function Od(a,b){for(var c=0;c<a.indexes.length;c++)if(!Gd(a.indexes[c].keyPath,b))return a.indexes[c];return r}function Pd(a,b){return b==a.keyPath?p:Ma(a.indexes,function(a){return a.name==b})}function Nd(a){return Ea(a.name)}
x.hint=function(a){if(!a)return this;var b=this.autoIncrement,c=A(this.keyPath)?Sa(this.keyPath):this.keyPath,d=this.type,e=Ka(this.indexes,function(a){return a.Ba()});!z(a.type)&&"TEXT"==d&&(d=m);A(a.keyPath)&&(C(c)&&c==a.keyPath.join(","))&&(c=Sa(a.keyPath));for(var f=0,g=a.indexes.length;f<g;f++)if(a.indexes[f].e)for(var h=a.indexes[f].getName(),l=e.length-1;0<=l;l--)if(0<=h.indexOf(e[l].getName())){e[l]=a.indexes[f].Ba();break}for(f=0;f<e.length;f++)(g=Md(a,e[f].getName()))&&(e[f]=e[f].hint(g));
return new Id(a.name,c,b,d,e)};x.getName=u("name");function Qd(a){return!!a.keyPath}function Rd(a,b){if(a.e){for(var c=[],d=0;d<a.keyPath.length;d++)c.push(tc(b,a.keyPath[d]));return c}if(a.keyPath)return Xa(b,a.d)}function Sd(a,b,c){for(var d=0;d<a.d.length;d++){var e=a.d[d];if(d==a.d.length-1){b[e]=c;break}z(b[e])||(b[e]={});b=b[e]}}
function Td(a,b,c){var d=[],e=[];c=z(c)?c:Rd(a,b);z(c)&&(e.push(a.a),d.push(vd(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&!(g.name===a.keyPath||"_default_"==g.name)){var h=Cd(g,b);h!=r&&(d.push(vd(h,g.type)),e.push(g.a))}}a.lc||(d.push(W(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Wb:e,ec:a,w:d,key:c}}
function Ud(a,b){if(!b)return"missing store: "+a.name;if(a.name!=b.name)return"store name, expect: "+a.name+", but: "+b.name;var c=Gd(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(z(a.autoIncrement)&&z(b.autoIncrement)&&a.autoIncrement!=b.autoIncrement)return"autoIncrement, expect:  "+a.autoIncrement+", but: "+b.autoIncrement;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(z(a.type)&&z(b.type)&&(B(a.type)?!Ua(a.type,b.type):
a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=Md(b,a.indexes[c].name),e;e=a.indexes[c];if(d)if(e.name!=d.name)e="name, expect: "+e.name+", but: "+d.name;else{var f=Gd(e.keyPath,d.keyPath);e=f?"keyPath, "+f:e.unique!=r&&d.unique!=r&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:e.multiEntry!=r&&d.multiEntry!=r&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:z(e.type)&&z(d.type)&&
(B(e.type)?!Ua(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.name;if(0<e.length)return'index "'+a.indexes[c].name+'" '+e}return""};function Vd(a,b){var c,d=b;if(G(a)){c=["version","stores"];for(var e in a)a.hasOwnProperty(e)&&-1==Ia(c,e)&&k(new S("Unknown field: "+e+" in schema."));c=a.version;d=[];e=a.stores||[];A(e)||k(new S("stores must be array"));for(var f=0;f<e.length;f++){var g=Jd(e[f]);-1!=Pa(d,function(a){return a.name==g.name})&&k(new S('duplicate store name "'+g.name+'".'));d.push(g)}}else C(a)?c=0==a.length?m:parseFloat(a):F(a)&&(c=a);z(c)&&((!F(c)||0>c)&&k(new S("Invalid version: "+c+" ("+a+")")),isNaN(c)&&(c=m));
z(b)&&(!A(b)||0<b.length&&!(b[0]instanceof Id))&&k(new S("stores"));this.version=c;this.sa=!z(this.version);this.stores=d||[]}x=Vd.prototype;x.toJSON=function(){var a=Ka(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;z(this.version)&&(b.version=this.version);return b};x.sa=s;x.F=ba(s);function Wd(a){return Ka(a.stores,function(a){return a.name})}x.ja=function(a){return this.stores[a]||r};x.count=function(){return this.stores.length};
function X(a,b){return Oa(a.stores,function(a){return a.name==b})}function Xd(a,b){return Ma(a.stores,function(a){return a.name==b})}function Yd(a,b,c){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var d=0;d<a.stores.length;d++){var e=X(b,a.stores[d].name),e=e&&c?e.hint(a.stores[d]):e,e=Ud(a.stores[d],e);if(0<e.length)return'store: "'+a.stores[d].name+'" '+e}return""};function Zd(a){Error.captureStackTrace?Error.captureStackTrace(this,Zd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}I(Zd,Error);function $d(a){Error.captureStackTrace?Error.captureStackTrace(this,$d):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}I(Zd,Error);$d.prototype.name="ydn.error.NotSupportedException";
function ae(a){Error.captureStackTrace?Error.captureStackTrace(this,ae):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}I(ae,Error);function be(a){Error.captureStackTrace?Error.captureStackTrace(this,be):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}I(be,Error);be.prototype.name="ydn.InternalError";
function ce(a){Error.captureStackTrace?Error.captureStackTrace(this,ce):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}I(ce,Error);ce.prototype.name="ydn.error.ConstraintError";function de(a){Error.captureStackTrace?Error.captureStackTrace(this,de):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}I(Zd,Error);
function ee(a){Error.captureStackTrace?Error.captureStackTrace(this,ee):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}I(ee,Error);function fe(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}k(Error("Invalid JSON string: "+a))}function ge(){}
function he(a,b,c){switch(typeof b){case "string":ie(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==r){c.push("null");break}if(A(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),he(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),ie(e,c),c.push(":"),he(a,f,c),d=","));c.push("}");
break;case "function":break;default:k(Error("Unknown type: "+typeof b))}}var je={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ke=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function ie(a,b){b.push('"',a.replace(ke,function(a){if(a in je)return je[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return je[a]=e+b.toString(16)}),'"')};M("ydn");var le="undefined"!=typeof y.JSON;function me(a){return!C(a)||/^[\s\xa0]*$/.test(a)?{}:le?JSON.parse(a):fe(a)}function ne(a){var b;try{b=W(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function W(a){if(le)a=JSON.stringify(a);else{var b=[];he(new ge,a,b);a=b.join("")}return a};function oe(a,b){z(a)&&5242880<a&&J(this.b,"storage size request ignored, use Quota Management API instead");this.o=r;this.Oa=b||NaN}
oe.prototype.wa=function(a,b){function c(a,c,d){K(e.b,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)pe(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Xd(b,c[d])||(a.deleteObjectStore(c[d]),K(e.b,"store: "+c[d]+" deleted."))}function d(a,b){f.W?J(e.b,"database already set."):z(b)?(J(e.b,b?b.message:"Error received."),e.o=r,f.n(b)):(e.o=a,e.o.onabort=function(a){L(e.b,e+": onabort - "+a.message)},e.o.onerror=function(a){L(e.b,e+
": onerror - "+a.message)},e.o.onversionchange=function(a){L(e.b,e+": onversionchange to: "+a.version);e.o&&(e.o.onabort=r,e.o.onerror=r,e.o.onversionchange=r,e.o.close(),e.o=r,ga(e.e)&&e.e())},O(f,parseFloat(g)))}var e=this,f=new N,g=m,h=b.version;K(e.b,"Opening database: "+a+" ver: "+(b.sa?"auto":h));var l;l=z(h)?qe.open(a,h):qe.open(a);l.onsuccess=function(f){var h=f.target.result;z(g)||(g=h.version);K(e.b,"Database: "+h.name+", ver: "+h.version+" opened.");if(b.sa)e.J(function(f){if(b.F())for(var g=
0;g<f.stores.length;g++)Xd(b,f.stores[g].getName())||re(b,f.stores[g].Ba());f=Yd(b,f);if(0<f.length){K(e.b,"Schema change require for difference in "+f);var l=F(h.version)?h.version+1:1;if("IDBOpenDBRequest"in y){h.close();var n=qe.open(a,l);n.onupgradeneeded=function(a){a=a.target.result;K(e.b,"re-open for version "+a.version);c(a,n.transaction,s)};n.onsuccess=function(a){d(a.target.result)};n.onerror=function(){K(e.b,e+": fail.");d(r)}}else{var t=h.setVersion(l+"");t.a=function(a){J(e.b,"migrating from "+
h.version+" to "+l+" failed.");d(r,a)};t.onsuccess=function(){t.transaction.oncomplete=T;c(h,t.transaction,p)};var T=function(){var b=qe.open(a);b.onsuccess=function(a){a=a.target.result;K(e.b,e+": OK.");d(a)};b.onerror=function(){K(e.b,e+": fail.");d(r)}};t.transaction!=r&&(t.transaction.oncomplete=T)}}else d(h)},m,h);else if(b.version>h.version){var l=h.setVersion(b.version);l.a=function(a){J(e.b,"migrating from "+h.version+" to "+b.version+" failed.");d(r,a)};l.onsuccess=function(){c(h,l.transaction,
p)}}else b.version==h.version?K(e.b,"database version "+h.version+" ready to go"):J(e.b,"connected database version "+h.version+" is higher than requested version."),e.J(function(a){a=Yd(b,a);0<a.length?(K(e.b,a),d(r,new ce("different schema: "+a))):d(h)},m,h)};l.onupgradeneeded=function(a){a=a.target.result;g=NaN;K(e.b,"upgrade needed for version "+a.version);c(a,l.transaction,s)};l.onerror=function(c){Yb(e.b,"opening database "+a+":"+b.version+" failed.");d(r,c)};l.onblocked=function(c){Yb(e.b,
"database "+a+" "+b.version+" block, close other connections.");d(r,c)};F(this.Oa)&&!isNaN(this.Oa)&&id(function(){"done"!=l.readyState&&(Yb(e.b,e+": database state is still "+l.readyState),d(r,new se("connection timeout after "+e.Oa)))},this.Oa);return f};var qe=y.indexedDB||y.mozIndexedDB||y.webkitIndexedDB||y.moz_indexedDB||y.msIndexedDB;x=oe.prototype;x.Oa=18E4;x.ka=ba("indexeddb");x.Rb=function(){return this.o||r};x.Sa=function(){return!!this.o};x.b=M("ydn.db.con.IndexedDb");x.o=r;
x.mb=function(){return this.o?parseFloat(this.o.version):m};
x.J=function(a,b,c){c=c||this.o;if(z(b)){if(b===r){if(0==c.objectStoreNames.length){a(new Vd(c.version));return}k(new be)}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new Vd(c.version));return}b=c.transaction(b,P)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var h=b.objectStore(e[d]),l=[],n=0,q=h.indexNames.length;n<q;n++){var t=h.index(h.indexNames[n]);l[n]=new zd(t.keyPath,m,t.unique,t.multiEntry,t.name)}f[d]=new Id(h.name,
h.keyPath,h.autoIncrement,m,l)}b=new Vd(c.version,f);a(b)};
function pe(a,b,c,d){function e(){var a={autoIncrement:!!d.autoIncrement};d.keyPath!=r&&(a.keyPath=d.keyPath);try{return b.createObjectStore(d.getName(),a)}catch(c){"InvalidAccessError"==c.name&&k(new te("creating store for "+d.getName()+" of keyPath: "+d.keyPath+" and autoIncrement: "+d.autoIncrement)),"ConstraintError"==c.name&&k(new ce("creating store for "+d.getName())),k(c)}}L(a.b,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName()))if(c=
c.objectStore(d.getName()),(d.keyPath||"")!=(c.keyPath||""))b.deleteObjectStore(d.getName()),J(a.b,"store: "+d.getName()+" deleted due to keyPath change."),c=e();else if(fa(c.autoIncrement)&&fa(d.autoIncrement)&&c.autoIncrement!=d.autoIncrement)b.deleteObjectStore(d.getName()),J(a.b,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e();else{for(var f=c.indexNames,g=0,h=0,l=0;l<d.indexes.length;l++){var n=d.indexes[l];if(!f.contains(n.name)){if(n.unique||n.multiEntry){var q={unique:n.unique,
multiEntry:n.multiEntry};c.createIndex(n.name,n.keyPath,q)}else c.createIndex(n.name,n.keyPath);g++}}for(l=0;l<f.length;l++)Pd(d,f[l])||(c.deleteIndex(f[l]),h++);L(a.b,"Updated store: "+c.name+", "+g+" index created, "+h+" index deleted.")}else{c=e();for(l=0;l<d.indexes.length;l++)n=d.indexes[l],L(a.b,"Creating index: "+n.name+" multiEntry: "+n.multiEntry),n.unique||n.multiEntry?(q={unique:n.unique,multiEntry:n.multiEntry},c.createIndex(n.name,n.keyPath,q)):c.createIndex(n.name,n.keyPath);L(a.b,"Created store: "+
c.name+" keyPath: "+c.keyPath)}}x.Za=function(a,b,c,d){var e=this.o;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(r):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onerror=function(a){d("error",a)},b.onabort=function(a){d("abort",a)},a(b),a=r)};x.lb=function(){this.o.close()};x.toString=function(){return"IndexedDB:"+(this.o?this.o.name+":"+this.o.version:"")};function ue(a){Error.captureStackTrace?Error.captureStackTrace(this,ue):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}I(ue,Error);ue.prototype.name="ConstraintError";function ve(a){Error.captureStackTrace?Error.captureStackTrace(this,ve):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}I(ve,Error);
function we(a){Error.captureStackTrace?Error.captureStackTrace(this,we):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}I(we,Error);we.prototype.name="ydn.db.VersionError";function xe(a){Error.captureStackTrace?Error.captureStackTrace(this,xe):this.stack=Error().stack||"";a&&(this.message=String(a))}I(xe,Error);xe.prototype.name="ydn.db.InternalError";
function ye(a){Error.captureStackTrace?Error.captureStackTrace(this,ye):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}I(ye,Error);function te(a){Error.captureStackTrace?Error.captureStackTrace(this,te):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}I(te,Error);function ze(a){Error.captureStackTrace?Error.captureStackTrace(this,ze):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}
I(ze,Error);ze.prototype.name="NotFoundError";function Ae(a){Error.captureStackTrace?Error.captureStackTrace(this,Ae):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="DataCloneError"}I(Ae,Error);function Be(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Be):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}I(Be,Error);
function Ce(a,b){Error.captureStackTrace?Error.captureStackTrace(this,Ce):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}I(Ce,Error);function De(a){Error.captureStackTrace?Error.captureStackTrace(this,De):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}I(De,Error);
function se(a){Error.captureStackTrace?Error.captureStackTrace(this,se):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}I(se,Error);function Ee(a){this.a=z(a)?a:4194304}x=Ee.prototype;
x.wa=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,f=c.sa?isNaN(f)?1:f+1:c.version;L(e.b,a+": changing version from "+b.version+" to "+f);var g=s,h=0;b.changeVersion(b.version,f+"",function(a){e.J(function(b){g=p;for(var d=0;d<c.count();d++){var f=X(b,c.ja(d).getName()),f=f?f.hint(c.ja(d)):r;Fe(e,a,c.ja(d),function(a){a&&h++},f)}if(c instanceof Ge)for(d=0;d<b.count();d++)f=b.ja(d),Xd(c,f.getName())||re(c,f)},a,b)},function(a){k(a)},function(){if(g){var f=".";h!=c.stores.length&&
(f=" but unexpected stores exists.");L(e.b,a+":"+b.version+" ready"+f);d(b)}else J(e.b,a+": changing version voided.")})}function d(a,b){z(b)?(e.u=r,g.n(b)):(e.u=a,O(g,parseFloat(f)))}var e=this,f=NaN,g=new N,h=r;try{h=y.openDatabase(a,"",a,this.a)}catch(l){"SECURITY_ERR"==l.name?(J(this.b,"SECURITY_ERR for opening "+a),h=r,this.Sb=new Ce(l)):k(l)}if(h){var f=h.version,n="database "+a+(0==h.version.length?"":" version "+h.version);b.version!=r&&b.version==h.version?(Zb(e.b,"Existing "+n+" opened as requested."),
d(h)):this.J(function(a){(a=Yd(b,a,p))?(0==h.version.length?Zb(e.b,"New "+n+" created."):b.sa?Zb(e.b,"Existing "+n+" opened and schema change for "+a):Zb(e.b,"Existing "+n+" opened and  schema change to version "+b.version+" for "+a),c(h,b)):(Zb(e.b,"Existing "+n+" with same schema opened."),d(h))},r,h)}else d(r,this.Sb);return g};x.ka=ba("websql");x.Sb=r;x.u=r;x.Rb=function(){return this.u||r};x.b=M("ydn.db.con.WebSql");
function He(a){var b=a.f,c="CREATE TABLE IF NOT EXISTS "+Nd(a)+" (",d=a.a,c=c+(d+" "+b+" PRIMARY KEY ");a.autoIncrement&&(c+=" AUTOINCREMENT ");for(var c=c+" ,_default_ BLOB",e=[],f=[d],g=0,h=a.indexes.length;g<h;g++){var l=a.index(g),n="";if(l.multiEntry)n=l.unique?" UNIQUE ":"",l="CREATE TABLE IF NOT EXISTS "+Ea("ydn.db.me:"+a.getName()+":"+l.getName())+" ("+d+" "+b+", "+l.a+" "+l.f+n+")",e.push(l);else{l.unique&&(n=" UNIQUE ");var q=l.a;-1==f.indexOf(q)&&(c+=", "+q+" "+l.f+n,f.push(q))}}e.push(c+
");");return e}x.mb=function(){return this.u?parseFloat(this.u.version):m};
x.J=function(a,b,c){function d(a,b){k(b)}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var w="sql"in e?e.sql:m;L(f.b,"Parsing table schema from SQL: "+w);for(var v=w.substr(w.indexOf("("),w.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),D=m,E,w=[],ua=s,T=s,U=0;U<v.length;U++){var ea=v[U].match(/\w+|"[^"]+"/g),Na=Ka(ea,function(a){return a.toUpperCase()}),pa=Ba(ea[0],'"'),ea=Ad(Na[1]);
if(-1!=Na.indexOf("PRIMARY")&&-1!=Na.indexOf("KEY"))C(pa)&&(!/^[\s\xa0]*$/.test(pa)&&"_ROWID_"!=pa)&&(D=pa),E=ea,-1!=Na.indexOf("AUTOINCREMENT")&&(ua=p);else if("_default_"==pa)T=p;else{var Eb="UNIQUE"==Na[2],Na=new zd(pa,ea,Eb);w.push(Na)}}if(0==e.name.lastIndexOf("ydn.db.me:",0))if((v=e.name.split(":"))&&3<=v.length){var bg=v[1],D=Pa(h,function(a){return a.getName()===bg}),v=new zd(v[2],ea,Eb,p);0<=D?(U=h[D],w.push(v),h[D]=new Id(U.getName(),U.keyPath,ua,E,w,m,!T)):h.push(new Id(bg,m,s,m,[v]))}else J(f.b,
'Invalid multiEntry store name "'+e.name+'"');else v=Pa(h,function(a){return a.getName()===e.name}),0<=v?(U=h[v].index(0),w.push(U),h[v]=new Id(e.name,D,ua,E,w,m,!T)):(w=new Id(e.name,D,ua,E,w,m,!T),h.push(w))}}d=new Vd(g,h);a(d)}}var f=this,g=(c=c||this.u)&&c.version?parseFloat(c.version):m,g=isNaN(g)?m:g,h=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.J(a,b,c)},function(a){Yb(f.b,"opening tx: "+a.message);k(a)},e)};
function Fe(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==h.length&&(d(p),d=r)},function(b,e){g++;g==h.length&&(d(s),d=r);k(new Be(e,"SQLError creating table: "+c.name+" "+e.message+' for executing "'+a))})}var g=0,h=He(c),l="Create";if(e){e=Ud(c,e);if(0==e.length){L(a.b,"same table "+c.name+" exists.");d(p);d=r;return}l="Modify";J(a.b,"table: "+c.name+" has changed by "+e+" additionallly TABLE ALTERATION is not implemented, dropping old table.");h.unshift("DROP TABLE IF EXISTS "+Ea(c.name))}L(a.b,
l+" table: "+c.name+": "+h.join(";"));for(a=0;a<h.length;a++)f(h[a])}x.Sa=function(){return!!this.u};x.lb=aa();x.Za=function(a,b,c,d){function e(a){L(h.b,h+": Tx "+c+" request cause error.");d("error",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var h=this;this.u===r&&(a(r),d("error",this.Sb));c==P?this.u.readTransaction(g,e,f):c==rc?this.u.changeVersion(this.u.version,this.u.version+1+"",g,e,f):this.u.transaction(g,e,f)};
function Ie(a){function b(){c.b.log(Qb,"all tables in "+a+" deleted.",m)}var c=new Ee,d=new Ge;K(c.b,"deleting websql database: "+a);d=c.wa(a,d);d.U(function(){c.Za(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,g){if(g&&g.rows){for(var h=g.rows.length,l=0,n=0;n<h;n++){var q=g.rows.item(n);"__WebKitDatabaseInfoTable__"==q.name||"sqlite_sequence"==q.name||(l++,L(c.b,"deleting table: "+q.name),b.executeSql("DROP TABLE "+q.name))}K(c.b,l+' tables deleted from "'+
a+'"')}},function(a,b){k(b)})},[],Q,b)});d.Vb(function(){J(c.b,"Connecting "+a+" failed.")})}x.toString=function(){return"WebSql:"+(this.u?":"+this.u.version:"")};function Je(a,b,c){a=["ydn.db",a];z(b)&&(a.push(b),z(c)&&(a.push(c),z(m)&&a.push(vc(m))));return a.join("^|")};function Ke(a){this.A=a||Le}function Le(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}x=Ke.prototype;x.s=r;x.A=r;x.P=r;x.O=r;
function Me(a,b){if(a.s==r)a.s=new Ne(b),a.P=a.s,a.O=a.s;else{var c=r;Oe(a,function(a){var e=r;0<this.A(a.value,b)?(e=a.left,a.left==r&&(c=new Ne(b,a),a.left=c,a==this.P&&(this.P=c))):0>this.A(a.value,b)&&(e=a.right,a.right==r&&(c=new Ne(b,a),a.right=c,a==this.O&&(this.O=c)));return e});c&&(Oe(a,function(a){a.count++;return a.parent},c.parent),Pe(a,c.parent))}}function Qe(a,b){Oe(a,function(a){var d=r;0<this.A(a.value,b)?d=a.left:0>this.A(a.value,b)?d=a.right:Re(this,a);return d})}
x.clear=function(){this.O=this.P=this.s=r};x.contains=function(a){var b=s;Oe(this,function(c){var d=r;0<this.A(c.value,a)?d=c.left:0>this.A(c.value,a)?d=c.right:b=p;return d});return b};x.Ca=function(){return this.s?this.s.count:0};x.ab=function(){var a=[];We(this,function(b){a.push(b)});return a};
function We(a,b){if(a.s){var c,d=c=Xe(a);for(c=c.left?c.left:c;d!=r;)if(d.left!=r&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=d.right!=r&&d.right!=c?d.right:d.parent;c=e}}}function Oe(a,b,c){for(c=c?c:a.s;c&&c!=r;)c=b.call(a,c)}
function Pe(a,b){Oe(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Ye(this,a.left),Ze(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Ze(this,a.right),Ye(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Ye(a,b){$e(b)?(b.parent.left=b.right,b.right.parent=b.parent):af(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.s=b.right,a.s.parent=r);var c=b.right;b.right=b.right.left;b.right!=r&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Ze(a,b){$e(b)?(b.parent.left=b.left,b.left.parent=b.parent):af(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.s=b.left,a.s.parent=r);var c=b.left;b.left=b.left.right;b.left!=r&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Re(a,b){if(b.left!=r||b.right!=r){var c=r,d;if(b.left!=r){d=bf(a,b.left);Oe(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.O&&(a.O=d)}else{d=Xe(a,b.right);Oe(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=b.parent;
d.left=b.left;d.left&&(d.left.parent=d);b==a.P&&(a.P=d)}d.count=b.count;$e(b)?b.parent.left=d:af(b)?b.parent.right=d:a.s=d;Pe(a,c?c:d)}else Oe(a,function(a){a.count--;return a.parent},b.parent),$e(b)?(b.parent.left=r,b==a.P&&(a.P=b.parent),Pe(a,b.parent)):af(b)?(b.parent.right=r,b==a.O&&(a.O=b.parent),Pe(a,b.parent)):a.clear()}function Xe(a,b){if(!b)return a.P;var c=b;Oe(a,function(a){var b=r;a.left&&(b=c=a.left);return b},b);return c}
function bf(a,b){if(!b)return a.O;var c=b;Oe(a,function(a){var b=r;a.right&&(b=c=a.right);return b},b);return c}function Ne(a,b){this.value=a;this.parent=b?b:r;this.count=1}Ne.prototype.left=r;Ne.prototype.right=r;Ne.prototype.height=1;function af(a){return!!a.parent&&a.parent.right==a}function $e(a){return!!a.parent&&a.parent.left==a};function cf(a){this.A=a||Le}I(cf,Ke);function df(a,b,c){if(a.s){var d;if(c instanceof Ne)d=c;else if(c){if(Oe(a,function(a){var b=r;0<this.A(a.value,c)?(b=a.left,d=a):0>this.A(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Xe(a);a=d;for(var e=d.left?d.left:d;a!=r;)if(a.left!=r&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=a.right!=r&&a.right!=e?a.right:a.parent;e=f}b(r)}}
function ef(a,b,c){if(a.s){var d;if(c instanceof Ne)d=c;else if(c){if(Oe(a,ma(function(a){var b=r;0<this.A(a.value,c)?b=a.left:(0>this.A(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=bf(a);a=d;for(var e=d.right?d.right:d;a!=r;)if(a.right!=r&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=a.left!=r&&a.left!=e?a.left:a.parent;e=f}b(r)}};function ff(a,b){this.key=a;this.a=b}ff.prototype.toString=function(){return"ydn.db.con.simple.Node:"+this.key+(this.a!=r?":"+this.a:"")};function gf(a,b){var c=V(a.key,b.key);return 0===c?a.a!=r?b.a!=r?V(a.a,b.a):1:b.a!=r?-1:0:c};function hf(a,b,c){this.g=a;this.d=b;this.e=c;this.a={};a=this.e.keyPath;this.c=A(a)?a.join(","):a||"_ROWID_";this.a[this.c]=r;this.f=Je(this.g,this.e.getName(),this.c)+"^|"}
function jf(a,b){var c=b||a.c;if(!a.a[c]){a.a[c]=new cf(gf);for(var d=a.d.length,e=0;e<d;e++){var f=a.d.key(e);if(f!==r&&0==f.lastIndexOf(a.f,0)){var g=yc(f.substr(a.f.length));if(c==a.c)Me(a.a[c],new ff(g));else{var h=a.d.getItem(f);if(h!==r)if(f=Md(a.e,c),h=me(h),h=Cd(f,h),f.multiEntry){if(A(h))for(f=0;f<h.length;f++)Me(a.a[c],new ff(h[f],g))}else Me(a.a[c],new ff(h,g))}}}}return a.a[c]}
function kf(a,b,c){for(var d in a.a){var e=a.a[d];if(e)if(d==a.c)Qe(e,new ff(b));else{var f=Md(a.e,d),f=tc(c,f.keyPath);Qe(e,new ff(b,f))}}}function lf(a){for(var b in a.a){var c=a.a[b];c&&c.clear()}a.a={}}
function mf(a,b,c,d){if(b==r&&(a.e.keyPath&&(b=Rd(a.e,c)),a.e.autoIncrement&&b==r)){b=a.f+vc(m);var e=me(a.d.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.d.setItem(b,W(e));b=e.key_count}if(d)if(a.a[a.c]){if(a.a[a.c].contains(vc(b)))return r}else if(a.d.getItem(a.f+vc(b))!==r)return r;a.d.setItem(a.f+vc(b),W(c));d=b;for(var f in a.a)if(e=a.a[f])if(f==a.c)Me(e,new ff(d));else{var g=Md(a.e,f),g=tc(c,g.keyPath);g!=r&&Me(e,new ff(d,g))}return b}
function nf(a,b){var c=a.f+vc(b),d=a.d.getItem(c);if(d===r)return 0;a.d.removeItem(c);c=me(d);kf(a,b,c);return 1}hf.prototype.clear=function(){lf(this);of(this)};function pf(a,b){var c=a.d.getItem(a.f+vc(b)),d=m;if(c!==r)for(var d=me(c),c=0,e=a.e.indexes.length;c<e;c++){var f=a.e.index(c);if("DATE"==f.type){var g=Cd(f,d);g&&Dd(f,d,new Date(g))}}return d;k("impl")}hf.prototype.getName=function(){return this.e.getName()};
function qf(a,b,c){b=b||a.c;a=jf(a,b);var d=r,e=r,f=0,g=s,h=s;c!=r&&(c.lower!=r&&(d=new ff(c.lower)),c.upper!=r&&(e=new ff(c.upper)),g=c.lowerOpen,h=c.upperOpen);df(a,function(a){if(a!=r&&(a=a.value,!g||!(d!=r&&0==V(a.key,d.key)))){if(e!=r&&(a=V(a.key,e.key),1===a||0===a&&h))return p;f++}},d);return f}
function of(a,b){var c=jf(a,a.c),d=r,e=r,f=0,g=[],h=[],l=s,n=s;b!=r&&(b.lower!=r&&(d=new ff(b.lower)),b.upper!=r&&(e=new ff(b.upper)),l=b.lowerOpen,n=b.upperOpen);df(c,function(b){if(b!=r&&(b=b.value,!l||!(d!=r&&0==gf(b,d)))){if(e!=r){var c=gf(b,e);if(1===c||0===c&&n)return p}var c=a.f+vc(b.key),w=a.d.getItem(c);w!==r&&(a.d.removeItem(c),f++,10>g.length&&(g.push(b.key),h.push(me(w))))}},d);if(10>g.length)for(c=0;c<g.length;c++)kf(a,g[c],h[c]);else lf(a);return f}
function rf(a,b,c,d,e,f,g,h){function l(c){if(c&&(D++,!(D<g))){var d=c.value;if(e){if(ua&&v!=r&&0==V(d.key,v.key))return;if(w!=r&&(c=V(d.key,w.key),-1===c||0===c&&E))return p}else{if(E&&w!=r&&0==V(d.key,w.key))return;if(v!=r&&(c=V(d.key,v.key),1===c||0===c&&ua))return p}c=d.key;if(!h||q!=r&&V(q,c))d=t?d.a:c,b?n.push(d):(d=pf(a,d),n.push(d));q=c;if(z(f)&&n.length>=f)return p}}var n=[],q;c=c||a.c;var t=c!=a.c;c=jf(a,c);var w=r,v=r;z(g)||(g=0);var D=-1,E=s,ua=s;d!=r&&(d.lower!=r&&(w=t&&e?new ff(d.lower,
"\uffff"):new ff(d.lower)),d.upper!=r&&(v=t&&!e?new ff(d.upper,"\uffff"):new ff(d.upper)),E=d.lowerOpen,ua=d.upperOpen);e?ef(c,l,v):df(c,l,w);return n}hf.prototype.ea=function(a,b,c,d,e){return rf(this,p,a,b,c,d,e)};hf.prototype.toString=function(){return"ydn.db.con.simple.Store:"+this.g+":"+this.e.getName()};function sf(a,b){this.h=a;this.a=b}function tf(a,b,c){id(function(){b.call(c,this.h)},0,a);return function(){a.a("complete",r);a.a=r;a.h=r}};function uf(){this.clear()}x=uf.prototype;x.Wa=function(){return this};x.setItem=function(a,b){z(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};x.getItem=function(a){return z(this.a[a])?this.a[a]:r};x.removeItem=function(a){delete this.a[a];Ra(this.keys,a.toString());this.length=this.keys.length};x.length=0;x.key=function(a){a=this.keys[a];return z(a)?this.a[a]:r};x.clear=function(){this.a={};this.keys=[];this.length=0};function vf(a){this.f=a||new uf;this.c=NaN}x=vf.prototype;x.b=M("ydn.db.con.SimpleStorage");x.mb=u("c");
x.wa=function(a,b){function c(a,b){id(function(){b?(K(d.b,d+" opening fail"),e.n(b)):(K(d.b,d+" version "+d.mb()+" open"),O(e,a))})}var d=this,e=new N;this.h=this.f.Wa(a);this.ca=a;this.a=b;this.d={};var f=Je(this.ca);this.c=NaN;var g=me(this.h.getItem(f));z(g.version)&&!F(g.version)&&(g.version=NaN);if(g)if(g=new Vd(g),Yd(this.a,g))if(!this.a.sa&&!isNaN(g.version)&&this.a.version>g.version)c(NaN,new we("existing version "+g.version+" is larger than "+this.a.version));else{var h=this.a.version;this.c=
z(h)?h:g.version+1;for(h=0;h<this.a.count();h++)var l=this.a.ja(h);if(this.a instanceof Ge)for(h=0;h<g.count();h++)l=g.ja(h),re(this.a,l);h=this.a.toJSON();h.version=this.c||NaN;this.h.setItem(f,W(h));c(g.version||NaN)}else{for(h=0;h<this.a.count();h++)l=this.a.ja(h);this.c=g.version||NaN;c(this.c)}else g=b.toJSON(),this.c=1,g.version=this.c,this.h.setItem(f,W(g)),c(NaN);return e};x.Sa=function(){return!!this.ca};x.Rb=function(){return this.h||r};x.ka=ba("memory");x.lb=aa();
x.Za=function(a,b,c,d){a(new sf(this,function(a,b){d(a,b)}))};x.J=function(a){id(function(){var b=Je(this.ca),b=this.h.getItem(b),b=new Vd(b);a(b)},0,this)};function wf(a,b){var c=X(a.a,b);c?a.d[b]||(a.d[b]=new hf(a.ca,a.h,c)):k(new yd('store name "'+b+'" not found.'));return a.d[b]}x.toString=function(){return"SimpleStorage:"+this.ka()+":"+(this.ca+":"+this.c)};function xf(){vf.call(this,this)}I(xf,vf);xf.prototype.Wa=function(){return window.localStorage};xf.prototype.ka=ba("localstorage");function yf(a){var b=new xf,c=new Ge;b.wa(a,c);b.J(function(a){for(var c=0;c<a.stores.length;c++)wf(b,a.stores[c].name).clear()})}function zf(){vf.call(this,this)}I(zf,vf);zf.prototype.Wa=function(){return window.sessionStorage};zf.prototype.ka=ba("sessionstorage");
function Af(a){var b=new zf,c=new Ge;b.wa(a,c);b.J(function(a){for(var c=0;c<a.stores.length;c++)wf(b,a.stores[c].name).clear()})};var V=qe&&qe.cmp?ma(qe.cmp,qe):Dc;function Bf(a,b,c,d){this.a=a;this.c=[];this.d=[];this.g=[];this.p=0;this.zb=this.G=s;b&&(this.c=Sa(b.c),this.d=Sa(this.d));c!=r&&(this.c[0]=c);d!=r&&(this.d[0]=d);this.e=function(){k(new yd)};this.f=function(){k(new yd)};0<this.a.length&&Cf(this)}x=Bf.prototype;x.p=0;x.G=s;x.zb=s;x.b=M("ydn.db.Cursor");
function Df(a,b){b.B=function(c,e,f){c==r&&(L(a.b,"cursor "+b+" finished."),a.G=p);a.c[0]=c;a.d[0]=e;a.g[0]=f;a.p++;a.G?(L(a.b,a+" DONE."),a.e(),Ef(a)):(L(a.b,a+" new cursor position {"+(a.d[0]!=r?a.c[0]+", "+a.d[0]:a.c[0])+"}"),a.e(a.c[0]))};b.Ka=function(b){a.f(b);Ef(a);a.G=p};var c=a.d[0]!=r?", "+a.d[0]:"",c=a.c[0]!=r?" resume from {"+a.c[0]+c+"}":"";L(a.b,b+c+" opening");b.xa(a.c[0],a.d[0])}
function Ff(a){function b(b){var f=a.a[b];f.B=function(l,q,t){d++;l==r&&(L(a.b,"cursor "+f+" finished."),a.G=p);a.c[b]=l;a.d[b]=q;a.g[b]=t;e[b]=!f.c?l:q;if(d==c){d=0;if(a.G)a.p++,L(a.b,a+" DONE."),a.e(),Ef(a);else if(l=e.reduce(function(a,b){return a===r?b:1==V(b,a)?b:a},r),0==V(l,e[0]))L(a.b,a+" new cursor position {"+(a.d[0]!=r?a.c[0]+", "+a.d[0]:a.c[0])+"}"),a.e(a.c[0]);else for(q=0;q<c;q++)-1==V(e[q],l)?(t=a.a[q],!t.c?t.la(l):t.Ta(l)):d++;Qa(e)}};f.Ka=function(b){a.f(b);Ef(a);a.G=p;d=0};var l=
a.d[b]!=r?", "+a.d[b]:"",l=a.c[b]!=r?" resume from {"+a.c[b]+l+"}":"";L(a.b,f+l+" opening");f.xa(a.c[b],a.d[b])}for(var c=a.a.length,d=0,e=[],f=0;f<c;f++)b(f)}function Cf(a){var b=a.a.length;1==b?Df(a,a.a[0]):1<b?Ff(a):k(new yd("no cursors"))}x.Ca=u("p");x.gc=function(a){return this.c[a||0]};x.L=function(a){a=a||0;return this.a[a].c?this.d[a]:this.c[a]};x.aa=function(a){a=a||0;return!this.a[a].Fa?this.g[a]:this.L(a)};x.advance=function(a){for(var b=0;b<this.a.length;b++)this.a[b].advance(a)};
x.update=function(a,b){return this.a[b||0].update(a)};x.clear=function(a){return this.a[a||0].clear()};function Gf(a){a.zb=p;L(a.b,a+": exit");Ef(a);for(var b=0;b<a.a.length;b++)a.a[b].X();L(a.b,a+" disposed");Qa(a.g);Qa(a.a)}function Ef(a){a.d=Ka(a.d,function(a){if(a!=r)return ld(a)});a.c=Ka(a.c,function(a){if(a!=r)return ld(a)})}x.toString=function(){for(var a="[",b=0;b<this.a.length;b++)a+=this.a[b].toString();return"Cursor "+(a+"]")};function Hf(a,b,c,d,e){if(!(b instanceof R)){var f;C(b)&&z(c)?f=wd(b,c,d,e):b!=r?b instanceof R?f=b:G(b)?f=new R(b.lower,b.upper,b.lowerOpen,b.upperOpen):k(new S("Invalid key range: "+b+" of type "+typeof b)):f=r;b=f}this.a=b;this.T=a}Hf.prototype.T="";Hf.prototype.vb=function(a){if(this.T!=a.T)return r;a=this.a!=r&&a.a!=r?this.a.vb(a.a):this.a||a.a;return new Hf(this.T,a)};function Y(a,b,c,d,e,f,g){C(a)||k(new S("store name must be a string"));this.S=a;this.g=b;this.k=g;this.e=!!this.g;this.d=z(f)?f:!!C(this.g);fa(this.d)||k(new S("key_only"));z(d)&&!fa(d)&&k(new S("reverse"));z(e)&&!fa(e)&&k(new S("unique"));a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.f=a;(d=td(c))&&k(new S("Invalid key range: "+d));this.c=rd(c);this.a=r}Y.prototype.d=p;function If(a,b,c){3<arguments.length&&k(new S("too many argument"));Y.call(this,a,m,b,c,m,p)}I(If,Y);
function Jf(a,b,c,d,e){C(b)||k(new S("index name must be string"));Y.call(this,a,b,c,d,e,p)}I(Jf,Y);function Kf(a,b,c){3<arguments.length&&k(new S("too many argument"));Y.call(this,a,m,b,c,m,s)}I(Kf,Y);function Lf(a,b,c,d,e){C(b)||k(new S("index name must be string"));Y.call(this,a,b,c,d,e,s)}I(Lf,Y);x=Y.prototype;x.Zb=function(){return this.a?this.a.G?"done":this.a.zb?"rest":"busy":"init"};x.b=M("ydn.db.Iterator");x.Gc=u("S");x.N=u("g");x.uc=u("c");
x.Ec=function(){return this.c?this.c instanceof sd?this.c:sd.bound(this.c.lower,this.c.upper,this.c.lowerOpen,this.c.upperOpen):r};x.Hc=u("d");x.tc=u("e");x.toJSON=function(){return{store:this.S,index:this.g,keyRange:this.c?md(this.c):r,direction:this.f}};
x.toString=function(){var a=z(this.k)?":"+this.k.join(","):z(this.g)?":"+this.g:"";this.c&&(a+=this.c.lowerOpen?" (":" [",this.c.lower!=r&&(a+=this.c.lower+", "),this.c.upper!=r&&(a+=this.c.upper),a+=this.c.upperOpen?")":"]");var b=this.e?"Index":"",b=b+(this.d?"Key":"Value");return b+"Iterator:"+this.S+a};x.Dc=function(){return this.a?this.a.gc():m};x.Fc=function(){return this.a?this.a.L():m};x.zc=function(a,b){this.a&&k(new xd("iterator in operation"));this.a=new Bf([],r,a,b)};
x.count=function(){return this.a?this.a.Ca():NaN};x.stores=function(){var a=[this.S];if(this.j)for(var b=0;b<this.j.length;b++)0<=Ia(a,this.j[b].a)||a.push(this.j[b].a);return a};x.Ic=function(){return"prev"===this.f||"prevunique"===this.f};x.hc=function(){return"nextunique"===this.f||"prevunique"===this.f};
function Mf(a,b,c,d,e){e=e||2;for(var f=[d.c(b,c,a.S,a.k||a.g,a.c,a.f,a.d,e)],g=0,h=a.j?a.j.length:0;g<h;g++){var l=a.j[g];if(l.c&&l.value!=r){var n;n=!a.e?sd.only(l.value):rd(qd([l.value]));l=d.c(b,c,l.a,l.c,n,a.f,a.d,e);f.push(l)}}a.a&&L(a.b,c+" "+a+" reused cursor "+a.a);a.a=new Bf(f,a.a);L(a.b,c+" "+a+" created "+a.a);return a.a}x.Jc=function(){"busy"==this.Zb()&&k(new ee("busy"));this.a=r};function Nf(a,b){this.ca=a;this.a=b}Nf.prototype.b=M("ydn.db.crud.req.RequestExecutor");Nf.prototype.ca="";Nf.prototype.toString=ba("RequestExecutor");Nf.prototype.N=function(a,b){return(A(b)?Od(a,b):Md(a,b)).getName()};H("ydn.db.con.IStorage.prototype.transaction",aa().prototype.transaction);function Of(a,b,c,d){"transaction"in a?(this.j=a,this.e=this.g=r):"objectStore"in a?(this.j=r,this.g=a.db,this.e=a,this.e.db.objectStoreNames.contains(b)||k(new Zd('store "'+b+'" not in transaction.'))):k(new Zd("storage instance require."));this.k=b;this.r=c;this.X=d;this.c=[];this.a=0;this.f=s}Of.prototype.b=M("ydn.db.con.IdbCursorStream");Of.prototype.f=s;Of.prototype.c=[];
function Pf(a,b){a.a++;b.onsuccess=function(b){if(b=b.target.result){if(ga(a.X)){var d=b.value;a.X(b.primaryKey,a.r!=r?d[a.r]:d)}else J(a.b,"sink gone, dropping value for: "+b.primaryKey);if(b&&0<a.c.length)b["continue"](a.c.shift());else a.a--,0==a.a&&a.V&&a.V()}};b.onerror=function(){J(a.b,"seeking fail. "+("error"in b?b.error.name+":"+b.error.message:""));a.a--;0==a.a&&a.V&&a.V()}}function Qf(a,b){0==a.c.length&&0==a.a?b():a.V=b}
function Rf(a){if(!a.f){var b=function(b,c){a.e=r;"complete"!==b&&J(a.b,c.name+":"+c.message);L(a.b,a+" transaction "+b)},c=function(b){var c=a.c.shift();L(a.b,a+" transaction started for "+c);b=b.objectStore(a.k);Pf(a,b.openCursor(c))};a.e?(L(a.b,a+" using existing tx."),c(a.e)):a.g?(L(a.b,a+" creating tx from IDBDatabase."),a.d=a.g.transaction([a.k],P),a.d.oncomplete=function(a){b("complete",a)},a.d.onerror=function(a){b("error",a)},a.d.onabort=function(a){b("abort",a)}):a.j?(L(a.b,a+" creating tx from ydn.db.con.IStorage."),
a.f=p,a.j.transaction(function(b){a.f=s;c(b)},[a.k],P,b)):k(new be("no way to create a transaction provided."))}};function Sf(a,b,c){a&&a instanceof Z?(this.Ra=a,this.ba=r):a&&a.db?(this.Ra=r,a.db?this.ba=new Of(a,this.a,this.va,ma(this.V,this)):k(new S("Invalid IndexedDB Transaction."))):k(new S("ydn.db.Streamer: First argument requires storage or transaction instance required."));C(b)||k(new S("a store name required."));this.a=b;z(c)&&!C(c)&&k(new S("index name must be a string."));this.va=c;this.ba=r;this.R=[];this.ia=[];this.Ea=s}x=Sf.prototype;x.b=M("ydn.db.Streamer");x.Ra=r;x.h=r;x.Qb=r;x.ia=[];x.R=[];
x.ba=r;x.Cc=function(a){this.Qb=a};function Tf(a){var b=0<a.R.length;if(b&&!a.Ea&&ga(a.Qb)){var c=function(){Tf(a)},d=a.ia.shift(),e=a.R.shift(),b=0<a.R.length,c=a.Qb(d,e,b?c:r);b&&!c&&Tf(a)}}x.Ea=s;x.Mc=function(a){if(this.ba){this.Ea=p;var b=this;Qf(this.ba,function(){a(b.ia,b.R);b.ia=[];b.R=[];b.Ea=s})}else a(this.ia,this.R),this.ia=[],this.R=[]};x.V=function(a,b){this.ia.push(a);this.R.push(b);Tf(this)};
x.push=function(a,b){this.Ea&&k(new ee("push not allowed after a collection is started"));if(2<=arguments.length)this.V(a,b);else{if(!this.ba){this.Ra||k(new ee("Database is not setup."));var c=this.Ra.g();c?"indexeddb"===c?this.ba=new Of(this.Ra,this.a,this.va,ma(this.V,this)):k(new ae(c)):k(new ee("Database is not connected."))}c=this.ba;c.c.push(a);Rf(c)}};x.N=u("va");x.toString=function(){return"Streamer:"+this.a+(this.va||"")};function Uf(a,b,c,d,e,f,g,h){Ec.call(this);this.ob=c;this.g=d;this.c=C(this.g);this.l=e||r;this.d=a;this.ua=b;this.reverse="prev"==f||"prevunique"==f;this.unique="nextunique"==f||"prevunique"==f;this.M=f;this.Fa=g;this.j=h}I(Uf,Ec);x=Uf.prototype;x.ob="";x.M="";x.l=r;x.unique=s;x.reverse=s;x.Fa=p;x.Ka=function(){k(new yd)};x.B=function(){k(new yd)};x.ra=function(){this.d=r};x.toString=function(){return"Cursor:"+this.ob+(z(this.g)?":"+this.g:"")+"["+(this.d?"":"~")+this.ua+"]"};function Vf(a,b){a!=r&&!("push"in a)&&k(new Zd);this.a=a||r;this.g=b;this.f=0}Vf.prototype.b=M("ydn.db.algo.AbstractSolver");Vf.prototype.a=r;Vf.prototype.c=function(a){A(a)||k(new TypeError("iterators must be array"));2>a.length&&k(new RangeError("ZigzagMerge require at least 2 iterators, but  only "+a.length+" found."));for(var b=0;b<a.length;b++)a[b]instanceof Y||k(new TypeError("item at iterators "+b+" is not an iterator."));return s};
function Wf(a,b,c){var d,e=d!=r;if(!z(d)){d=c[0];for(var e=d!=r,f=1;e&&f<c.length;f++)if(c[f]==r||0!=V(c[f],d))e=s}return e&&(a.f++,a.a&&a.a.push(d),z(a.g)&&a.f>=a.g)?[]:b}Vf.prototype.d=function(){return[]};function Xf(a,b,c,d,e,f,g,h){Uf.call(this,a,b,c,d,e,f,g,h);this.t=r}I(Xf,Uf);x=Xf.prototype;x.b=M("ydn.db.core.req.IDBCursor");x.Ya=function(a){(a=a.target.result)?this.B(a.key,this.c?a.primaryKey:m,a.value):this.B()};x.t=r;
x.xa=function(a,b){function c(a,b,c){h.t=g;h.B(a,h.c?b:m,c);h.t.onsuccess=ma(h.Ya,h)}var d=this.l,e=this.d.objectStore(this.ob),f=C(this.g)?e.index(this.g):r,g;g=!this.Fa?f?this.M!=r?f.openCursor(d,this.M):d!=r?f.openCursor(d):f.openCursor():this.M!=r?e.openCursor(d,this.M):d!=r?e.openCursor(d):e.openCursor():f?this.M!=r?f.openKeyCursor(d,this.M):d!=r?f.openKeyCursor(d):f.openKeyCursor():this.M!=r?e.openCursor(d,this.M):d!=r?e.openCursor(d):e.openCursor();var h=this;g.onerror=function(){h.Ka(g.error)};
a!=r?g.onsuccess=function(d){if(d=d.target.result){var e=qe.cmp(d.key,a);if(1==e)c(d.key,d.primaryKey,d.value);else if(-1==e)d["continue"](a);else if(b!=r)if(1==qe.cmp(d.primaryKey,b))c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(h.t=g,h.t.onsuccess=ma(h.Ya,h))};x.eb=function(){return!!this.t};x.update=function(a){var b=this.t.result;if(b){var c=new N;a=b.update(a);a.onsuccess=function(a){O(c,a.target.result)};a.onerror=function(a){c.n(a)};return c}k(new te("cursor gone"))};
x.clear=function(){var a=this.t.result;if(a){var b=new N,a=a["delete"]();a.onsuccess=function(){O(b,1)};a.onerror=function(a){b.n(a)};return b}k(new te("cursor gone"))};x.Ua=function(a,b){L(this.b,this+" restarting.");this.xa(b,a)};x.advance=function(a){var b=this.t.result;if(1==a)b["continue"]();else b.advance(a)};
x.Ta=function(a){var b=this.t.result,c=qe.cmp(a,b.primaryKey);1!=c&&k(new yd('continuing primary key "'+a+'" must higher than current primary key "'+b.primaryKey+'"'));var d=this;this.t.onsuccess=function(e){if(b=e.target.result)if(c=qe.cmp(b.primaryKey,a),0==c||1==c&&!d.reverse||-1==c&&d.reverse)d.t.onsuccess=ma(d.Ya,d),d.B(b.key,d.c?b.primaryKey:m,b.value);else b["continue"]();else d.t.onsuccess=ma(d.Ya,d),d.B()};b["continue"]()};x.la=function(a){var b=this.t.result;if(a!=r)b["continue"](a);else b["continue"]()};
x.ra=function(){Xf.D.ra.call(this);this.t=r};function Yf(a,b){Nf.call(this,a,b)}I(Yf,Nf);x=Yf.prototype;x.b=M("ydn.db.crud.req.IndexedDb");x.Xa=function(a,b,c,d){function e(b){var h=a.objectStore(d[b]).count();h.onsuccess=function(a){f[b]=a.target.result;b++;b==d.length?(c(f),c=r):e(b)};h.onerror=function(a){c(a,p);c=r}}var f=[];L(this.b,b+" countStores: "+d);0==d.length?(c([]),c=r):e(0)};
x.tb=function(a,b,c,d,e,f){a=a.objectStore(d);L(this.b,b+" addObject: "+d+" "+f);var g;g=z(f)?a.add(e,f):a.add(e);g.onsuccess=function(a){c(a.target.result)};g.onerror=function(){c(g.error,p)}};x.Jb=function(a,b,c,d,e,f){a=a.objectStore(d);L(this.b,b+" putObject: "+d+" "+(z(f)?f:""));b=z(f)?a.put(e,f):a.put(e);b.onsuccess=function(a){c(a.target.result)};b.onerror=function(a){"DataError"==a.name&&(a=W(e),a=new ve(d+": "+a.substring(0,70)));c(a,p)}};
x.ub=function(a,b,c,d,e,f){function g(a){var b;b=f!=r?n.add(e[a],f[a]):n.add(e[a]);b.onsuccess=function(b){l++;h[a]=b.target.result;l==e.length?c(h):(b=a+10,b<e.length&&g(b))};b.onerror=function(f){l++;"DataError"==f.name?new ve('put to "'+d+'": '+a+" of "+e.length):"DataCloneError"==f.name&&new Ae('put to "'+d+'": '+a+" of "+e.length);c(b.error,p)}}var h=[],l=0,n=a.objectStore(d);L(this.b,b+" addObjects: "+d+" "+e.length+" objects");if(0<e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
x.Kb=function(a,b,c,d,e,f){function g(a){var b;b=f!=r?t.put(e[a],f[a]):t.put(e[a]);b.onsuccess=function(b){l++;h[a]=b.target.result;l==e.length?n?c(h,p):c(h):(b=a+10,b<e.length&&g(b))};b.onerror=function(f){l++;J(q.b,"request result "+f.name+' error when put to "'+d+'" for object "'+ne(e[a])+'" at index '+a+" of "+e.length+" objects.");h[a]=b.error;n=p;l==e.length?n?c(h,p):c(h):(f=a+10,f<e.length&&g(f))}}var h=[],l=0,n=s,q=this,t=a.objectStore(d);L(this.b,b+" putObjects: "+d+" "+e.length+" objects");
if(0<e.length)for(a=0;10>a&&a<e.length;a++)g(a);else c([])};
x.Ib=function(a,b,c,d,e){function f(b){var c=e[b],v=c.a,D=a.objectStore(v),E;E=D.keyPath===r?D.put(d[b],c.id):D.put(d[b]);E.onsuccess=function(a){l++;h[b]=a.target.result;l==d.length?g():(a=b+10,a<d.length&&f(a))};E.onerror=function(a){l++;J(q.b,"request result "+a.name+' error when put keys to "'+v+'" for object "'+ne(d[b])+'" at index '+b+" of "+d.length+" objects.");h[b]=E.error;n=p;l==d.length?g():(a=b+10,a<d.length&&f(a))}}function g(){n?c(h,p):c(h)}var h=[],l=0,n=s,q=this;L(this.b,b+" putByKeys: of "+
d.length+" objects");if(0<d.length)for(b=0;10>b&&b<d.length;b++)f(b);else g()};x.ib=function(a,b,c,d,e){a=a.objectStore(d);L(this.b,b+" clearById: "+d+" "+e);var f=a.openCursor(sd.only(e));f.onsuccess=function(a){var b=a.target.result;b?(b=b["delete"](),b.onsuccess=function(){c(1)},b.onerror=function(){c(a,p)}):c(m)};f.onerror=function(){c(f.error,p)}};
x.Mb=function(a,b,c,d){function e(b){if(b>=d.length)c(f,g);else{d[b].a!=h&&(h=d[b].a,l=a.objectStore(h));var q=l.openCursor(sd.only(d[b].id));q.onsuccess=function(a){b++;(a=a.target.result)?(a=a["delete"](),a.onsuccess=function(){f++;e(b)},a.onerror=function(){g=p;e(b)}):e(b)};q.onerror=function(){c(q.error,p)}}}var f=0,g=s,h,l;L(this.b,b+" removeByKeys: "+d.length+" keys");e(0)};
x.jb=function(a,b,c,d,e){var f=this,g=a.objectStore(d),h=g.count(e),l=b+" clearByKeyRange: "+d+" "+e;L(this.b,l);h.onsuccess=function(a){var b=a.target.result;a=g["delete"](e);a.onsuccess=function(){c(b)};a.onerror=function(){c(h.error,p)}};h.onerror=function(a){L(f.b,"count error "+l);c(a,p)}};x.yb=function(a,b,c,d,e){a=a.objectStore(d);L(this.b,b+" clearByKeyRange: "+d+" "+e);var f=a["delete"](e);f.onsuccess=function(){c(m)};f.onerror=function(){c(f.error,p)}};
x.Lb=function(a,b,c,d,e,f){var g=this;a=a.objectStore(d).index(e);var h=b+" clearByIndexKeyRange: "+d+":"+e+" "+f;L(this.b,h);var l=a.openCursor(f),n=0;l.onsuccess=function(a){var b=a.target.result;if(b){var d=b["delete"]();d.onsuccess=function(){n++;b["continue"]()};d.onerror=function(){L(g.b,"error "+h);k(d.error)}}else c(n)};l.onerror=function(){c(l.error,p)}};
x.Va=function(a,b,c,d){var e=d.length,f=0;L(this.b,b+" clearByStores: "+d);for(b=0;b<e;b++){var g=a.objectStore(d[b]).clear();g.onsuccess=function(){f++;f==e&&c(f)};g.onerror=function(){f++;f==e&&c(g.error,p)}}};
function Zf(a,b,c,d,e,f,g,h,l,n,q){var t=[];b=b.objectStore(e);var w=sc(h,q),v=c+" listByKeyRange: "+e+(f?":"+f:"")+(g?W(g):"");h&&(v+=" reverse");q&&(v+=" unique");L(a.b,v);var D;D=f?b.index(f).openCursor(g,w):b.openCursor(g,w);var E=s;D.onsuccess=function(b){if(b=b.target.result)if(!E&&0<n)E=p,b.advance(n);else if(t.push(b.value),t.length<l)b["continue"]();else L(a.b,"success "+v),d(t);else d(t)};D.onerror=function(){d(D.error,p)}}x.Ia=function(a,b,c,d,e,f,g,h){Zf(this,a,b,c,d,r,e,f,g,h)};
x.Ha=function(a,b,c,d,e,f,g,h,l,n){Zf(this,a,b,c,d,e,f,g,h,l,n)};x.Db=function(a,b,c,d,e,f,g,h){var l=[];a=a.objectStore(d);f=sc(f);L(this.b,b+" keysByKeyRange: "+d+" "+e);var n=a.openCursor(e,f),q=s;n.onsuccess=function(a){if(a=a.target.result)if(!q&&0<h)q=p,a.advance(h);else if(l.push(a.key),l.length<g)a["continue"]();else c(l);else c(l)};n.onerror=function(){c(n.error,p)}};
x.Cb=function(a,b,c,d,e,f,g,h,l,n){var q=[];a=a.objectStore(d).index(e);L(this.b,b+" keysByStore: "+d+":"+e+" "+f);var t=a.openKeyCursor(f,sc(g,n)),w=s;t.onsuccess=function(a){if(a=a.target.result)if(!w&&0<l)w=p,a.advance(l);else{if(q.push(a.primaryKey),q.length<h)a["continue"]()}else c(q)};t.onerror=function(){c(t.error,p)}};x.$a=function(a,b,c,d,e){L(this.b,b+" getById: "+d+":"+e);var f=a.objectStore(d).get(e);f.onsuccess=function(a){c(a.target.result)};f.onerror=function(){c(f.error,p)}};
x.Eb=function(a,b,c,d,e){function f(a){if(e[a]==r)if(h++,g[a]=m,h==n)c(g);else{var b=a+10;b<n&&f(b)}var d;try{d=l.get(e[a])}catch(v){"DataError"==v.name&&k(new ve(e[a])),k(v)}d.onsuccess=function(b){h++;g[a]=b.target.result;h==n?c(g):(b=a+10,b<n&&f(b))};d.onerror=function(){h++;c(d.error,p)}}var g=[],h=0,l=a.objectStore(d),n=e.length;L(this.b,b+" listByIds: "+d+":"+n+" ids");if(0<n)for(a=0;10>a&&a<n;a++)f(a);else c([])};
x.Fb=function(a,b,c,d){function e(b){var l=d[b],n=a.objectStore(l.a).get(l.id);n.onsuccess=function(a){g++;f[b]=a.target.result;g==d.length?c(f):(a=b+10,a<d.length&&e(a))};n.onerror=function(){g++;c(n.error,p)}}var f=[],g=0;L(this.b,b+" listByKeys: "+d.length+" ids");if(0<d.length)for(b=0;10>b&&b<d.length;b++)e(b);else c([])};
x.oa=function(a,b,c,d,e,f){a=a.objectStore(d);b=b+" countKeyRange: "+d+(f?":"+f:"")+(e?":"+W(e):"");L(this.b,b);var g;f!=r?(f=a.index(f),g=e!=r?f.count(e):f.count()):g=e!=r?a.count(e):a.count();g.onsuccess=function(a){c(a.target.result)};g.onerror=function(){c(g.error,p)}};function $f(a,b){Nf.call(this,a,b)}I($f,Yf);$f.prototype.b=M("ydn.db.core.req.IndexedDb");$f.prototype.e=function(a,b,c,d,e,f){var g=[],h=b+" keysByIterator:"+d,l=this;L(this.b,h);var n=Mf(d,a,b,this);n.f=function(a){J(l.b,"error:"+h);c(a,p)};var q=0,t=s;n.e=function(a){z(a)?!t&&0<f?(n.advance(f),t=p):(q++,g.push(a),!z(e)||q<e?n.advance(1):(Gf(n),c(g))):(Gf(n),c(g))}};
$f.prototype.d=function(a,b,c,d,e,f){var g=[],h=b+" listByIterator "+d;0<e&&(h=" limit "+e);L(this.b,h);var l=Mf(d,a,b,this);l.f=function(a){Gf(l);c(a,p)};var n=0,q=s;l.e=function(a){if(z(a)){a=d.e?l.L():a;var b=l.aa();!q&&0<f?(l.advance(f),q=p):(n++,g.push(d.d?a:b),!z(e)||n<e?l.a[0].la(m):(Gf(l),c(g)))}else Gf(l),c(g)}};$f.prototype.c=function(a,b,c,d,e,f,g,h){var l=X(this.a,c);z(d)&&(d=this.N(l,d));return new Xf(a,b,c,d,e,f,g,h)};function ag(){this.a=s}ag.prototype.a=s;function cg(a,b,c,d,e,f,g,h,l){Uf.call(this,a,b,d,e,f,g,h,l);this.kb=this.Ma=this.ta=m;this.Hb=this.k=this.e=this.a=r;this.f=new ag}I(cg,Uf);x=cg.prototype;x.b=M("ydn.db.core.req.SimpleCursor");x.eb=function(){return!!this.d};x.update=function(){k("no update")};x.advance=function(a){function b(b){d++;if(!b||d>=a)return dg(c,b)}var c=this,d=this.a?-1:0;this.reverse?ef(this.e,b,this.a):df(this.e,b,this.a)};
x.la=function(a){if(a!=r){var b=this,c=new ff(a),d=function(c){b.a=c;if(!c)return dg(b,c);var d=V(c.value.key,a);if(b.reverse){if(1!=d)return dg(b,c)}else if(-1!=d)return dg(b,c)};this.reverse?ef(this.e,d,c):df(this.e,d,c)}else this.advance(1)};function eg(a){id(function(){a.f.a?(a.f.a=s,this.B(this.ta,this.Ma,this.kb),eg(this)):(this.Hb(),this.Hb=r)},0,a)}
function dg(a,b){if(a.a=b){var c=b.value;if(a.l)if(!a.reverse&&a.l.upper!=r){var d=V(c.key,a.l.upper);if(1==d||0==d&&a.l.upperOpen)a.a=r}else if(a.reverse&&a.l.lower!=r&&(d=V(c.key,a.l.lower),-1==d||0==d&&a.l.lowerOpen))a.a=r;if(a.a){if(a.unique&&(a.ta!=r&&c.key!=r)&&0==V(a.ta,c.key))return;a.ta=c.key;a.Ma=a.c?c.a:a.ta;a.j||(!a.Fa?a.kb=pf(a.k,a.Ma):a.kb=a.Ma)}}a.a||(a.ta=m,a.Ma=m,a.kb=m);return a.f.a=p}
x.xa=function(a,b){var c=r;this.l&&this.l.lower!=r&&(c=new ff(this.l.lower));a!=r&&(c=this.c?new ff(a,b):new ff(a));this.Hb=tf(this.d,function(d){function e(c){var d=c.value,e=d.key;if(c&&e!=r)if(a!=r)if(b!=r){if(d=d.a,d!=r&&0==V(a,e)&&0==V(b,d))return}else{if(0==V(a,e))return}else if(this.l&&(!this.reverse&&this.l.lowerOpen&&(d=V(e,this.l.lower),0==d)||this.reverse&&this.l.upperOpen&&(d=V(e,this.l.upper),0==d)))return p;return dg(this,c)}this.k=wf(d,this.ob);this.e=jf(this.k,this.g);this.reverse?
ef(this.e,ma(e,this),c):df(this.e,ma(e,this),c);eg(this)},this)};x.clear=function(){k("no clear")};x.Ua=function(){k("no restart")};x.Ta=function(){k("no p cont")};function fg(a,b){Nf.call(this,a,b)}I(fg,Nf);x=fg.prototype;x.b=M("ydn.db.crud.req.SimpleStore");x.Cb=function(a,b,c,d,e,f,g,h,l){var n=b+" keysByIndexKeyRange "+d+":"+e+" "+(f?ne(f):"");L(this.b,n);var q=tf(a,function(a){a=wf(a,d).ea(e,f,g,h,l);K(this.b,"success "+n);c(a);q();q=r},this)};x.Db=function(a,b,c,d,e,f,g,h){var l=b+" keysByKeyRange "+d+" "+(e?ne(e):"");L(this.b,l);var n=tf(a,function(a){a=wf(a,d).ea(r,e,f,g,h);K(this.b,"success "+l);c(a);n();n=r},this)};
x.Ib=function(a,b,c,d,e){gg(this,a,b,c,r,d,e,p,s)};function gg(a,b,c,d,e,f,g,h,l){var n=c+" "+(h?"put":"add")+"Object"+(l?"":"s "+f.length+" objects");L(a.b,n);var q=tf(b,function(b){var c;if(l)c=wf(b,e),b=mf(c,g,f,!h),b!=r?d(b):(b=ne(b),b=new ue(b),d(b,p));else{for(var v=e,D=[],E=s,ua=g||{},T=0;T<f.length;T++){var U;e?U=ua[T]:(v=g[T],U=v.id,v=v.a);if(!c||c.getName()!=v)c=wf(b,v);U=mf(c,U,f[T],!h);U!=r||(E=p);D.push(U)}K(a.b,(E?"error ":"success ")+n);d(D,E)}q();q=r},a)}
x.tb=function(a,b,c,d,e,f){gg(this,a,b,c,d,e,f,s,p)};x.Jb=function(a,b,c,d,e,f){gg(this,a,b,c,d,e,f,p,p)};x.ub=function(a,b,c,d,e,f){gg(this,a,b,c,d,e,f,s,s)};x.Kb=function(a,b,c,d,e,f){gg(this,a,b,c,d,e,f,p,s)};x.$a=function(a,b,c,d,e){var f=tf(a,function(a){a=pf(wf(a,d),e);c(a);f();f=r},this)};
function hg(a,b,c,d,e){var f=tf(b,function(a){for(var b=[],l=s,n=d,q,t=0;t<e.length;t++){var w=e[t];w instanceof kd&&(n=w,w=n.id,n=n.a);if(!q||q.getName()!=n)q=wf(a,n);w=pf(q,w);w!=r||(l=p);b.push(w)}c(b,l);f();f=r},a)}x.Eb=function(a,b,c,d,e){hg(this,a,c,d,e)};x.Fb=function(a,b,c,d){hg(this,a,c,r,d)};
x.Ia=function(a,b,c,d,e,f,g,h){var l=b+" listByKeyRange "+d+" "+(e?ne(e):"");L(this.b,l);var n=tf(a,function(a){a=wf(a,d);a=rf(a,s,r,e,f,g,h);K(this.b,l+" "+a.length+" records found.");c(a);n();n=r},this)};x.Ha=function(a,b,c,d,e,f,g,h,l,n){var q=b+" listByIndexKeyRange "+d+" "+(f?ne(f):"");L(this.b,q);var t=tf(a,function(a){a=rf(wf(a,d),s,e,f,g,h,l,n);K(this.b,q+" "+a.length+" records found.");c(a);t();t=r},this)};
x.ib=function(a,b,c,d,e){var f=b+" removeById "+d+" "+e;L(this.b,f);var g=this,h=tf(a,function(a){a=nf(wf(a,d),e);K(g.b,"success "+f+(0==a?" [not found]":""));c(a);h();h=r},this)};x.Mb=function(a,b,c,d){var e=b+" removeByKeys "+d.length+" keys";L(this.b,e);var f=this,g,h=0,l=tf(a,function(a){for(var b=0;b<d.length;b++){var t=d[b].a,w=d[b].id;if(!g||g.getName()!=t)g=wf(a,t);h+=nf(g,w)}K(f.b,"success "+e+h+" deleted");c(h);l();l=r},this)};x.yb=function(a,b,c,d,e){this.jb(a,b,c,d,e)};
x.jb=function(a,b,c,d,e){var f=b+" removeByKeyRange "+(e?W(e):"");L(this.b,f);var g=this,h=tf(a,function(a){a=of(wf(a,d),e);K(g.b,f+" deleted "+a+" records.");c(a);h();h=r},this)};x.Lb=function(a,b,c,d,e,f){var g=b+" removeByIndexKeyRange "+(f?W(f):"");L(this.b,g);var h=this,l=tf(a,function(a){a=wf(a,d);for(var b=a.ea(e,f),t=b.length,w=0;w<t;w++)nf(a,b[w]);K(h.b,g+" deleted "+t+" records.");c(t);l();l=r},this)};
x.Va=function(a,b,c,d){var e=b+" clearByStores";L(this.b,e);var f=tf(a,function(a){for(var b=0;b<d.length;b++)wf(a,d[b]).clear();K(this.b,"success "+e);c(d.length);f();f=r},this)};x.Xa=function(a,b,c,d){var e=b+" countStores";L(this.b,e);var f=tf(a,function(a){for(var b=[],l=0;l<d.length;l++){var n=wf(a,d[l]);b.push(qf(n))}K(this.b,"success "+e);c(b);f();f=r},this)};
x.oa=function(a,b,c,d,e,f){var g=b+" count"+(f!=r?"Index":"")+(e!=r?"KeyRange":"Store");L(this.b,g);var h=tf(a,function(a){a=qf(wf(a,d),f,e);K(this.b,"success "+g);c(a);h();h=r},this)};function ig(a,b){Nf.call(this,a,b)}I(ig,fg);ig.prototype.e=function(a,b,c,d,e,f){var g=[],h=b+" keysByIterator:"+d,l=this;L(this.b,h);var n=Mf(d,a,b,this);n.f=function(a){J(l.b,"error:"+h);c(a,p)};var q=0,t=s;n.e=function(a){a!=r?!t&&0<f?(n.advance(f),t=p):(q++,g.push(a),!z(e)||q<e?n.advance(1):(Gf(n),L(l.b,"success:"+h),c(g))):(Gf(n),L(l.b,"success:"+h),c(g))}};
ig.prototype.d=function(a,b,c,d,e,f){var g=[],h=b+" listByIterator"+d,l=this;L(this.b,h);var n=Mf(d,a,b,this);n.f=function(a){K(l.b,"error:"+h);Gf(n);c(a,s)};var q=0,t=s;n.e=function(a){if(a!=r){a=d.e?n.L():a;var b=n.aa();!t&&0<f?(n.advance(f),t=p):(q++,g.push(d.d?a:b),!z(e)||q<e?n.advance(1):(K(l.b,"success:"+h),Gf(n),c(g)))}else L(l.b,"success:"+h),Gf(n),c(g)}};ig.prototype.c=function(a,b,c,d,e,f,g,h){var l=X(this.a,c);z(d)&&(d=this.N(l,d));return new cg(a,b,0,c,d,e,f,g,h)};function jg(a,b,c,d,e,f,g,h,l){Uf.call(this,a,b,d,e,f,g,h,l);this.a=c;this.k=C(e)?Md(c,e):r;this.e=this.f=m}I(jg,Uf);x=jg.prototype;x.b=M("ydn.db.core.req.WebsqlCursor");function kg(a,b){a.f=m;a.e=m;a.r=m;if(z(b))if(G(b)){var c=Ed(b[a.a.c],a.a.type);if(a.c){var d;d=Md(a.a,a.g).type;a.e=c;a.f=Ed(b[a.g],d)}else a.f=c;a.r=a.Fa?c:lg(b,a.a)}else a.r=b}
function mg(a,b,c){Md(a.a,a.g);var d=[],e=a.g,f=a.l,g=a.f;if(f!=r){var h=f.lower,l=f.upper,n=f.lowerOpen,f=f.upperOpen;a.reverse?l=l!=r&&-1==V(l,g)?l:g:h=h!=r&&1==V(h,g)?h:g;f=h!=r&&l!=r?nd(h,l,!!n,!!f):h!=r?sd.lowerBound(h,!!n):sd.upperBound(l,!!f)}else f=a.reverse?sd.upperBound(g):sd.lowerBound(g);e=Ld(a.a,d,a.j,e,f,a.reverse,a.unique);c=a.reverse?sd.upperBound(c,s):sd.lowerBound(c,s);c=Ld(a.a,d,a.j,a.a.c,c,a.reverse,a.unique);e.m=e.m?e.m+(" AND "+c.m):c.m;c="SELECT "+e.select+" FROM "+e.qa+(e.m?
" WHERE "+e.m:"")+(e.group?" GROUP BY "+e.group:"")+" ORDER BY "+e.Y;c+=" LIMIT 1";L(a.b,a+": continuePrimary:  SQL: "+c+" : "+W(d));a.d.executeSql(c,d,function(c,d){0<d.rows.length?kg(a,d.rows.item(0)):kg(a);b.call(a,a.f,a.e,a.r);b=r},function(c,d){J(a.b,"get error: "+d.message);a.Ka(d);kg(a);b.call(a,a.e,a.f,a.r);b=r;return s})}
function ng(a,b,c,d,e){var f=a.k.c,g=a.k.a,h=a.a.a,l=a.reverse?" <":" >",l=d?l+" ":l+"= ";d=vd(c,a.k.type);e=vd(e,a.a.type);var n="";a.l?(a=Ld(a.a,b,a.j,f,a.l,a.reverse,a.unique),a.m+=" AND ",n=g+l+"?",b.push(d)):(c=a.reverse?od(c,p):pd(c,p),a=Ld(a.a,b,a.j,f,c,a.reverse,a.unique),n=a.m,a.m="");a.m+="("+n+" OR ("+g+" = ? AND "+h+l+"?))";b.push(d);b.push(e);return"SELECT "+a.select+" FROM "+a.qa+" WHERE "+a.m+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.Y}
function og(a,b,c,d){var e,f,g,h;if(a.l!=r)if(e=a.l.lower,f=a.l.upper,g=a.l.lowerOpen,h=a.l.upperOpen,a.reverse)if(f!=r){var l=V(c,f);-1==l?(f=c,h=d):0==l&&(h=d||h)}else f=c,h=d;else e!=r?(l=V(c,e),1==l?(e=c,g=d):0==l&&(g=d||g)):(e=c,g=d);else a.reverse?(f=c,h=d):(e=c,g=d);c=new R(e,f,!!g,!!h);b=Ld(a.a,b,a.j,a.k?a.k.c:a.a.c,c,a.reverse,a.unique);b="SELECT "+b.select+" FROM "+b.qa+(b.m?" WHERE "+b.m:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.Y;a.c&&(b+=", "+a.a.a+(a.reverse?"DESC":"ASC"));
return b}function pg(a,b,c,d,e,f){var g=!d;d=[];f!=r?c=ng(a,d,c,g,f):c!=r?c=og(a,d,c,g):(c=Kd(a.a,d,a.j,!a.c?a.a.c:a.k.c,a.l,a.reverse,a.unique),a.c&&(c+=", "+a.a.a+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);L(a.b,a+": continue:  SQL: "+c+" : "+W(d));a.d.executeSql(c,d,function(c,d){0<d.rows.length?kg(a,d.rows.item(0)):kg(a);b.call(a,a.f,a.e,a.r);b=r},function(c,d){J(a.b,"get error: "+d.message);a.Ka(d);kg(a);b.call(a,a.e,a.f,a.r);b=r;return s})}x.eb=function(){return!!this.d};
x.update=function(a){this.eb()||k(new te);var b=new N,c=this,d=this.e;a=Td(c.a,a,d);var e="REPLACE INTO "+Nd(this.a)+" ("+a.Wb.join(", ")+") VALUES ("+a.ec.join(", ")+") ON CONFLICT FAIL";L(c.b,this+': clear "'+e+'" : '+W(a.w));this.d.executeSql(e,a.w,function(){O(b,d)},function(a,d){J(c.b,"get error: "+d.message);b.n(d);return s});return b};
x.advance=function(a){var b=this.f,c=this.e,d=p;if(this.f!=r&&(!this.c||this.e!=r))a-=1,d=s;pg(this,function(a,d,g){var h=b!=r&&a!=r&&0==V(b,a);if(this.c){var l=d!=r&&c!=r&&0==V(d,c);h&&l&&k(new yd("current: "+b+";"+c+" next: "+a+";"+d))}else h&&k(new yd("current: "+b+" next: "+a));this.B(a,d,g)},this.f,d,a,this.e)};x.la=function(a){a!=r?pg(this,this.B,a,p):this.advance(1)};x.xa=function(a,b){pg(this,this.B,a,s,0,b)};
x.clear=function(){this.eb()||k(new te);var a=new N,b=this,c=this.a.c,c="DELETE FROM "+Nd(this.a)+" WHERE "+c+" = ?",d=[this.e];L(b.b,this+': clear "'+c+'" : '+W(d));this.d.executeSql(c,d,function(b,c){O(a,c.rowsAffected)},function(c,d){J(b.b,"get error: "+d.message);a.n(d);return s});return a};x.Ua=function(a,b){L(this.b,this+" restarting.");this.xa(b,a)};
x.Ta=function(a){var b=V(a,this.e);(0==b||1==b&&this.reverse||-1==b&&!this.reverse)&&k(new ee(this+" to continuePrimaryKey  from "+this.e+" to "+a+" on "+this.M+" direction is wrong"));mg(this,this.B,a)};function qg(a,b){Nf.call(this,a,b)}I(qg,Nf);x=qg.prototype;x.b=M("ydn.db.crud.req.WebSql");function lg(a,b){var c=a._default_?me(a._default_):{};if(b.keyPath!=r){var d=Ed(a[b.keyPath],b.type);d!=r&&Sd(b,c,d)}for(d=0;d<b.indexes.length;d++){var e=b.indexes[d],f=e.c;if(!("_default_"==f||e.e||e.multiEntry)&&"DATE"==e.type)f=Ed(a[f],e.type),z(f)&&Dd(e,c,f)}return c}x.Db=function(a,b,c,d,e,f,g,h){rg(this,a,b,c,p,d,m,e,f,g,h,s)};x.Cb=function(a,b,c,d,e,f,g,h,l,n){rg(this,a,b,c,p,d,e,f,g,h,l,n)};
function rg(a,b,c,d,e,f,g,h,l,n,q,t){var w=[],v=X(a.a,f),D=v.c;g!=r&&g!==D&&Md(v,g);f=[];g=Kd(v,f,e?1:2,g||D,h,l,t);F(n)&&(g+=" LIMIT "+n);F(q)&&(g+=" OFFSET "+q);var E=c+" SQL: "+g+" ;params= "+W(f);L(a.b,E);b.executeSql(g,f,function(b,c){for(var f=c.rows.length,g=0;g<f;g++){var h=c.rows.item(g);e?w[g]=Ed(h[D],v.type):h!=r&&(w[g]=lg(h,v))}K(a.b,"success "+E);d(w)},function(b,c){J(a.b,"error: "+E+c.message);d(c,p);return s})}x.tb=function(a,b,c,d,e,f){sg(this,a,b,c,p,p,d,[e],[f])};
x.Jb=function(a,b,c,d,e,f){sg(this,a,b,c,s,p,d,[e],[f])};x.ub=function(a,b,c,d,e,f){sg(this,a,b,c,p,s,d,e,f)};
function sg(a,b,c,d,e,f,g,h,l){function n(b,g){h[b]==r&&k(new xd("inserting "+(z(h[b])?"null":"undefined")+"object "+(1==h.length?"":" at "+b+" of "+h.length)+' "'+ne(h[b])));var T;T=z(l)?Td(q,h[b],l[b]):Td(q,h[b]);var U=t+Nd(q)+" ("+T.Wb.join(", ")+") VALUES ("+T.ec.join(", ")+");",ea=c+" SQL: "+U+" PARAMS: "+T.w+" REQ: "+b+" of "+h.length;L(a.b,ea);g.executeSql(U,T.w,function(e,l){function U(b,d){var e=t+Ea("ydn.db.me:"+q.getName()+":"+b.getName())+" ("+q.a+", "+b.a+") VALUES (?, ?)",f=[vd(ea,q.type),
d];L(a.b,c+" multiEntry "+e+" "+f);g.executeSql(e,f,aa(),function(b,c){J(a.b,"multiEntry index insert error: "+c.message);return s})}v++;for(var ea=z(T.key)?T.key:l.insertId,$b=0,Qh=q.indexes.length;$b<Qh;$b++){var Te=q.index($b);if(Te.multiEntry)for(var Ue=tc(h[b],Te.keyPath),Rh=(!Ue?0:Ue.length)||0,Ve=0;Ve<Rh;Ve++)U(Te,Ue[Ve])}f?(K(a.b,"success "+D),d(ea)):(w[b]=ea,v==h.length?(K(a.b,"success "+D),d(w)):($b=b+2,$b<h.length&&n($b,e)))},function(c,g){v++;if(6==g.code){g.name="ConstraintError";if(f)K(a.b,
"success "+ea),d(g,p);else if(w[b]=r,v==h.length)L(a.b,"success "+D),d(w);else{var l=b+2;l<h.length&&n(l,c)}return e&&f?p:s}J(a.b,"error: "+g.message+" "+D);d(g,p);return s})}var q=X(a.a,g),t=e?"INSERT INTO ":"INSERT OR REPLACE INTO ",w=[],v=0,D=c+" inserting "+h.length+" objects.";if(0<h.length)for(g=0;2>g&&g<h.length;g++)n(g,b);else K(a.b,"success"),d([])}x.Kb=function(a,b,c,d,e,f){sg(this,a,b,c,s,s,d,e,f)};
x.Ib=function(a,b,c,d,e){if(0==e.length)c([]);else{for(var f=[],g=0,h=0,l=this,n=function(n,q){var t=[];L(l.b,"put "+q.length+" objects to "+n);for(var w=Qd(X(l.a,n)),v=w?m:[],D=0;D<q.length;D++)t.push(d[q[D]]),w||v.push(e[q[D]].id);sg(l,a,b,function(a,b){if(b)g++,g==h&&c(a,p);else{for(var d=0;d<q.length;d++)f[q[d]]=a[d];g++;g==h&&c(f)}},s,s,n,t,v)},q="",t=[],w=[],v=0;v<e.length;v++){var D=e[v].a,E=e[v].id;D!=q?(h++,0<t.length&&n(q,t),t=[v],w=[E],q=D):(t.push(v),w.push(E))}0<t.length&&n(q,t)}};
x.$a=function(a,b,c,d,e){var f=X(this.a,d),g=this;d=f.a;e=[vd(e,f.type)];d="SELECT * FROM "+Nd(f)+" WHERE "+d+" = ?";var h=b+" SQL: "+d+" PARAMS: "+e;L(this.b,h);a.executeSql(d,e,function(a,b){if(0<b.rows.length){var d=b.rows.item(0);d!=r?(d=lg(d,f),c(d)):(K(g.b,"success: "+h),c(m))}else K(g.b,"success no result: "+h),c(m)},function(a,b){J(g.b,"error: "+h+" "+b.message);c(b,p);return s})};
x.Eb=function(a,b,c,d,e){function f(a,d){var w=n.a,v=[vd(e[a],n.type)],D="SELECT * FROM "+Nd(n)+" WHERE "+w+" = ?";L(g.b,"SQL: "+D+" PARAMS: "+v);d.executeSql(D,v,function(d,t){l++;if(0<t.rows.length){var w=t.rows.item(0);w!=r&&(h[a]=lg(w,n))}else h[a]=m;l==e.length?(K(g.b,"TxNo:"+b+"success "+D),c(h)):(w=a+10,w<e.length&&f(w,d))},function(d,n){l++;J(g.b,"error: "+D+" "+n.message);if(l==e.length)K(g.b,"TxNo:"+b+"success "+D),c(h);else{var t=a+10;t<e.length&&f(t,d)}return s})}var g=this,h=[],l=0,n=
X(this.a,d);if(0<e.length)for(d=0;10>d&&d<e.length;d++)f(d,a);else K(g.b,"success"),c([])};x.Ia=function(a,b,c,d,e,f,g,h){rg(this,a,b,c,s,d,m,e,f,g,h,s)};x.Ha=function(a,b,c,d,e,f,g,h,l,n){rg(this,a,b,c,s,d,e,f,g,h,l,n)};
x.Fb=function(a,b,c,d){function e(a,b){var q=d[a],t=X(f.a,q.a),w=A(q.id)?q.id.join("^|"):q.id instanceof Date?+q.id:q.id,q=t.a,w=[vd(w,t.type)],v="SELECT * FROM "+Nd(t)+" WHERE "+q+" = ?";L(f.b,"SQL: "+v+" PARAMS: "+w);b.executeSql(v,w,function(b,n){h++;if(0<n.rows.length){var q=n.rows.item(0);q!=r&&(g[a]=lg(q,t))}else g[a]=m;h==d.length?(L(f.b,"success "+v),c(g)):(q=a+10,q<d.length&&e(q,b))},function(a,b){J(f.b,"error: "+v+" "+b.message);c(b,p);return s})}var f=this,g=[],h=0;if(0<d.length)for(b=
0;10>b&&b<d.length;b++)e(b,a);else L(this.b,"success"),c([])};
x.Va=function(a,b,c,d){function e(a,b){function l(a){a="DELETE FROM  "+Ea("ydn.db.me:"+n.getName()+":"+a.getName());L(f.b,"SQL: "+a);b.executeSql(a,[])}var n=X(f.a,d[a]),q="DELETE FROM  "+Nd(n);L(f.b,"SQL: "+q+" PARAMS: []");b.executeSql(q,[],function(b){a==d.length-1?(L(f.b,"success "+q),c(d.length)):e(a+1,b)},function(a,b){J(f.b,"error: "+q+" "+b.message);c(b,p);return s});for(var t=0,w=n.indexes.length;t<w;t++){var v=n.index(t);v.multiEntry&&l(v)}}var f=this;0<d.length?e(0,a):(L(this.b,"success"),
c(0))};
x.Mb=function(a,b,c,d){function e(n){if(n>=d.length)L(f.b,"success "+l),c(g,h);else{var q=X(f.a,d[n].a),t=vd(d[n].id,q.type),w=" WHERE "+q.a+" = ?",v="DELETE FROM "+Nd(q)+w,D=b+" SQL: "+v+" PARAMS: "+[t];a.executeSql(v,[t],function(){g++;e(n)},function(a,b){J(f.b,"error: "+D+b.message);h=p;e(n);return s});n++;for(var v=function(c){c="DELETE FROM  "+Ea("ydn.db.me:"+q.getName()+":"+c.getName())+w;L(f.b,b+NaN+c);a.executeSql(c,[t])},E=0,ua=q.indexes.length;E<ua;E++){var T=q.index(E);T.multiEntry&&v(T)}}}
var f=this,g=0,h=s,l=b+" removeByKeys: "+d.length+" keys";L(this.b,l);e(0)};
x.ib=function(a,b,c,d,e){function f(c){c="DELETE FROM  "+Ea("ydn.db.me:"+g.getName()+":"+c.getName())+n;L(l.b,b+NaN+c);a.executeSql(c,[h])}var g=X(this.a,d),h=vd(e,g.type),l=this,n=" WHERE "+g.a+" = ?";d="DELETE FROM "+Nd(g)+n;var q=b+" SQL: "+d+" PARAMS: "+[h];L(this.b,q);a.executeSql(d,[h],function(a,b){L(l.b,"success "+q);c(b.rowsAffected)},function(a,b){J(l.b,"error: "+q+b.message);c(b,p);return s});d=0;for(e=g.indexes.length;d<e;d++){var t=g.index(d);t.multiEntry&&f(t)}};
x.yb=function(a,b,c,d,e){tg(this,a,b,c,d,m,e)};x.jb=function(a,b,c,d,e){tg(this,a,b,c,d,m,e)};x.Lb=function(a,b,c,d,e,f){tg(this,a,b,c,d,e,f)};
function tg(a,b,c,d,e,f,g){function h(d){d="DELETE FROM  "+Ea("ydn.db.me:"+l.getName()+":"+d.getName())+t;L(a.b,c+NaN+d);b.executeSql(d,q)}var l=X(a.a,e);e="DELETE FROM "+Nd(l);var n=[],q=[],t="";g!=r&&(z(f)?(f=Md(l,f),ud(f.a,f.type,g,q,n)):ud(l.a,l.type,g,q,n),t=" WHERE "+q.join(" AND "));e+=t;var w=c+" SQL: "+e+" PARAMS: "+n;L(a.b,w);b.executeSql(e,n,function(b,c){L(a.b,"success "+w);d(c.rowsAffected)},function(b,c){J(a.b,"error: "+w+c.message);d(c,p);return s});g=0;for(f=l.indexes.length;g<f;g++)e=
l.index(g),e.multiEntry&&h(e)}x.Xa=function(a,b,c,d){function e(b){var l="SELECT COUNT(*) FROM "+Ea(d[b]);L(f.b,"SQL: "+l+" PARAMS: []");a.executeSql(l,[],function(a,q){var t=q.rows.item(0);g[b]=parseInt(t["COUNT(*)"],10);b++;L(f.b,b+". success "+l);b==d.length?c(g):e(b)},function(a,b){J(f.b,"error: "+l+" "+b.message);c(b,p);return s})}var f=this,g=[];0==d.length?(L(this.b,"success"),c(0)):e(0);return c};
x.oa=function(a,b,c,d,e,f,g){var h=this,l=[];d=Kd(X(this.a,d),l,3,f,e,s,g);var n=b+" SQL: "+d+" PARAMS: "+l;L(this.b,n);a.executeSql(d,l,function(a,b){var d=b.rows.item(0);L(h.b,"success "+n);c(ug(d))},function(a,b){J(h.b,"error: "+n+b.message);c(b,p);return s});return c};function vg(a,b){Nf.call(this,a,b)}I(vg,qg);vg.prototype.b=M("ydn.db.core.req.WebSql");vg.prototype.e=function(a,b,c,d,e,f){wg(this,a,b,c,d,1,e,f)};vg.prototype.d=function(a,b,c,d,e,f){wg(this,a,b,c,d,2,e,f)};
function wg(a,b,c,d,e,f,g,h){var l=[],n=c+" "+(1==f?"keys":2==f?"values":3==f?"count":"")+"ByIterator "+e;K(a.b,n);var q=Mf(e,b,c,a,f);q.f=function(b){K(a.b,"error:"+n);Gf(q);d(b,p)};var t=0,w=s;q.e=function(b){if(z(b)){var c=q.L(),E=q.aa();!w&&0<h?(q.advance(h),w=p):(t++,l.push(1==f?b:e.e&&e.d?c:E),!z(g)||t<g?q.a[0].la(m):(Gf(q),K(a.b,"success:"+n+" "+l.length+" records"),d(l)))}else Gf(q),K(a.b,"success:"+n+" "+l.length+" records"),d(l)}}
vg.prototype.c=function(a,b,c,d,e,f,g,h){var l=X(this.a,c);z(d)&&(d=this.N(l,d));return new jg(a,b,l,c,d,e,f,g,h)};function xg(a){a?ga(a.abort)?a.abort():ga(a.executeSql)?a.executeSql("ABORT",[],aa(),ba(p)):k(new $d):k(new ye("No active transaction"))};/*
 _try.
*/
function yg(a,b,c){this.h=a;this.c=0;this.a=[];this.ha=this.d=r;this.q=new zg(b);this.sb=c||0}x=yg.prototype;x.q=r;x.sb=0;x.b=M("ydn.db.tr.Serial");x.fa=function(){return this.q.c};x.Tc=function(){return this.q.a&&!this.q.d?this.q.a:r};H("ydn.db.tr.Serial.prototype.getTx",yg.prototype.Tc);x=yg.prototype;x.ha=r;x.type=function(){return this.h.g()};x.$b=ba(s);function Ag(a,b,c,d,e){L(a.b,"Serial push tx queue "+b.name);a.a.push({pa:b,I:c,mode:d,C:e})}x.abort=function(){K(this.b,this+": aborting");xg(this.ha)};
x.Na=function(a,b,c,d){var e=C(b)?[b]:b;if(B(e)){0==e.length&&k(new S("number of store names must more than 0"));for(var f=0;f<e.length;f++)C(e[f])||k(new S("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]))}else k(new S("store names must be an array"));var g=z(c)?c:P,h=this;if(this.q.a||(!this.h.a||!this.h.a.Sa())&&0<(this.d!==r))Ag(this,a,b,g,d);else{var l=Bg(this.q);this.d=d?[d]:[];this.sb&&this.fa()>=this.sb&&k(new xd("Exceed maximum number of transactions of "+this.sb));
this.h.transaction(function(c){var d=h.q;d.a=c;d.d=s;d.I=b;d.mode=g;d.c++;d.C=r;l=Bg(h.q);Zb(h.b,l+" BEGIN "+W(b)+" "+g);a(h);for(a=r;h.$b();)c=h.a.shift(),c.C&&h.d.push(c.C),L(h.b,"pop tx queue in continue "+c.pa.name),c.pa()},e,g,function(a,b){"complete"==a?Zb(h.b,l+" COMMITTED"):Zb(h.b,l+" COMMITTED with "+a);try{for(var c;c=h.d.shift();)c(a,b)}catch(d){k(d)}finally{c=h.q,c.a?(c.a=r,c.I=r,c.mode=r,ga(c.C)&&c.C(a,b),c.C=r):J(c.b,c+" has no TX to be unlocked for "+a),(c=h.a.shift())&&h.Na(c.pa,c.I,
c.mode,c.C)}h.c=0})}};x.Tb=ba(s);x.i=function(a,b,c,d,e){d=d||P;var f=this,g;if(f.q.a&&!f.q.d&&this.Tb(c,d)){var h=f.q.a;f.c++;g=Bg(f.q)+"R"+f.c;K(f.b,g+" BEGIN");b(h,g,function(b,c){f.ha=h;c?(K(f.b,g+" ERROR"),a.n(b)):(K(f.b,g+" SUCCESS"),O(a,b));f.ha=r});K(f.b,g+" END");b=r}else f.Na(function(){var c=f.q.a;f.c++;g=Bg(f.q)+"R"+f.c;K(f.b,g+" BEGIN");b(c,g,function(b,d){f.ha=c;d?(K(f.b,g+" ERROR"),a.n(b)):(K(f.b,g+" SUCCESS"),O(a,b));f.ha=r});K(f.b,g+" END");b=r},c,d,e)};x.getName=function(){return this.h.getName()};
x.toString=function(){return"Serial:"+Bg(this.q)+(this.ha?"*":"")};function Cg(a,b){yg.call(this,a,b)}I(Cg,yg);Cg.prototype.b=M("ydn.db.tr.AtomicSerial");Cg.prototype.i=function(a,b,c,d,e){var f,g,h=new N;h.z(function(a){g=s;f=a},function(a){g=p;f=a});Cg.D.i.call(this,h,b,c,d,function(b,c){if(g===p)a.n(f);else if(g===s)O(a,f);else{var d=new se;a.n(d)}e&&(e(b,c),e=m)})};function Dg(a,b,c){this.h=a;this.c=b;this.a=c;this.d=r}Dg.prototype.b=M("ydn.db.tr.DbOperator");Dg.prototype.fa=function(){return this.a.fa()};Dg.prototype.abort=function(){this.a.abort()};function $(a){a.d||(a.d=a.h.Gb());return a.d}Dg.prototype.toString=function(){return"TxStorage:"+this.h.getName()};function Eg(a,b,c){Dg.call(this,a,b,c)}I(Eg,Dg);x=Eg.prototype;x.b=M("ydn.db.crud.DbOperator");
x.count=function(a,b,c,d){var e=oc(),f=this,g,h,l;if(z(a))if(A(a)){(z(c)||z(b))&&k(new S("too many arguments."));g=a;for(b=0;b<g.length;b++)Xd(this.c,g[b])||k(new S('store name "'+g[b]+'" at '+b+" not found."));K(this.b,"countStores: "+W(g));this.a.i(e,function(a,b,c){$(f).Xa(a,b,c,g)},g,P)}else C(a)?(Xd(this.c,a)||k(new S('store name "'+a+'" not found.')),z(d)&&!fa(d)&&k(new TypeError('unique value "'+d+'" must be boolean, but found '+typeof d+".")),g=[a],C(b)?(h=b,G(c)?((b=td(c))&&k(new S("invalid key range: "+
ne(c)+" "+b)),l=rd(c)):(c!=r&&k(new S("invalid key range: "+ne(c)+" of type "+typeof c)),l=r)):G(b)||!z(b)?G(b)?((c=td(b))&&k(new S("invalid key range: "+ne(b)+" "+c)),l=rd(b)):(b!=r&&k(new S("key range must be  an object but found "+ne(b)+" of type "+typeof b)),l=r):k(new S("key range must be an object, but "+ne(c)+" of type "+typeof b+" found.")),K(this.b,"countKeyRange: "+g[0]+" "+(h?h:"")+W(l)),this.a.i(e,function(a,b,c){$(f).oa(a,b,c,g[0],l,h,!!d)},g,P)):k(new S("Invalid store name or store names."));
else{(z(c)||z(b))&&k(new S("too many arguments."));g=Wd(this.c);var n=new N;K(this.b,"countStores: "+W(g));this.a.i(e,function(a,b,c){$(f).Xa(a,b,c,g)},g,P);e.z(function(a){a=La(a,function(a,b){return b+a});O(n,a)},function(a){n.n(a)});return n}return e};
x.ya=function(a,b){var c=this,d=oc();if(a instanceof kd){var e=a.a;if(!Xd(this.c,e)){if(this.c.F())return mc(m);k(new S("Store: "+e+" not found."))}var f=a.id;K(this.b,"getById: "+e+":"+f);this.a.i(d,function(a,b,d){$(c).$a(a,b,d,e,f)},[e],P)}else if(C(a)&&z(b)){if(!X(this.c,a)){if(this.c.F())return mc(m);k(new S('Store name "'+a+'" not found.'))}if(b instanceof sd||b instanceof R){var g=new N;g.z(function(a){O(d,a[0])},function(a){d.n(a)});var h=td(b);h&&k(new S("invalid key range: "+b+" "+h));var l=
rd(b);K(this.b,"getById: "+a+":"+W(l));this.a.i(g,function(b,d,e){$(c).Ia(b,d,e,a,l,s,1,0)},[a],P)}else K(this.b,"getById: "+a+":"+b),this.a.i(d,function(d,e,f){$(c).$a(d,e,f,a,b)},[a],P)}else k(new S("get require valid input arguments."));return d};
x.keys=function(a,b,c,d,e,f){var g=this,h,l,n=r,q=s,t=X(this.c,a);C(a)||k(new S("store name must be a string, but "+a+" of type "+typeof a+" is not."));this.c.F()||(t||k(new S('store name "'+a+'" not found.')),C(b)&&!Md(t,b)&&k(new S('index "'+b+'" not found in store "'+a+'".')));if(this.c.F()&&!t)return mc([]);t=new N;if(C(b)){var w=td(c);w&&k(new S("invalid key range: "+c+" "+w));n=rd(c);F(d)?h=d:(z(d)&&k(new S("limit must be a number")),h=100);F(e)?l=e:(z(e)&&k(new S("offset must be a number")),
l=0);z(f)&&(fa?q=f:k(new S("reverse must be a boolean")));K(this.b,"keysByIndexKeyRange: "+a);this.a.i(t,function(c,d,e){$(g).Cb(c,d,e,a,b,n,q,h,l,s)},[a],P)}else G(b)?((w=td(b))&&k(new S("invalid key range: "+ne(b)+" "+w)),n=rd(b)):(b!=r&&k(new TypeError("invalid key range: "+ne(b)+" of type "+typeof b)),n=r),F(c)?h=c:(z(c)&&k(new S("limit must be a number")),h=100),F(d)?l=d:(z(d)&&k(new S("offset must be a number")),l=0),z(e)&&(fa(e)?q=e:k(new S("reverse must be a boolean"))),K(this.b,"keysByKeyRange: "+
a),this.a.i(t,function(b,c,d){$(g).Db(b,c,d,a,n,q,h,l)},[a],P);return t};
x.w=function(a,b,c,d,e,f){var g=this,h=oc(),l,n,q=s;if(C(a)){if(!X(this.c,a)){if(this.c.F())return mc([]);k(new ze(a))}if(A(b))(z(c)||z(d))&&k(new S("too many input arguments")),K(this.b,"listByIds: "+a+" "+b.length+" ids"),this.a.i(h,function(c,d,e){$(g).Eb(c,d,e,a,b)},[a],P);else if(C(b)){var t=td(c);t&&k(new S("invalid key range: "+c+" "+t));var w=rd(c);z(d)?F(d)?l=d:k(new S("limit must be a number.")):l=100;z(e)?F(e)?n=e:k(new S("offset must be a number.")):n=0;fa(f)?q=f:z(f)&&k(new S("reverse must be a boolean, but "+
f));K(this.b,"listByIndexKeyRange: "+a+":"+b);this.a.i(h,function(c,d,e){$(g).Ha(c,d,e,a,b,w,q,l,n,s)},[a],P)}else w=r,G(b)?((t=td(b))&&k(new S("invalid key range: "+b+" "+t)),w=rd(b)):b!=r&&k(new TypeError('expect key range object, but found "'+ne(b)+'" of type '+typeof b)),z(c)?F(c)?l=c:k(new S("limit must be a number, but "+c+" is "+typeof c)):l=100,z(d)?F(d)?n=d:k(new S("offset must be a number, but "+d+" is "+typeof d)):n=0,z(e)&&(fa(e)?q=e:k(new S("reverse must be a boolean, but "+e+" is "+
typeof e))),K(this.b,(w?"listByKeyRange: ":"listByStore: ")+a),this.a.i(h,function(b,c,d){$(g).Ia(b,c,d,a,w,q,l,n)},[a],P)}else if(A(a))if(a[0]instanceof kd){c=[];for(d=0;d<a.length;d++){e=a[d].a;if(!Xd(this.c,e)){if(this.c.F())return h=[],h[a.length-1]=m,mc(h);k(new S("Store: "+e+" not found."))}0<=Ia(c,e)||c.push(e)}K(this.b,"listByKeys: "+W(c)+" "+a.length+" keys");this.a.i(h,function(b,c,d){$(g).Fb(b,c,d,a)},c,P)}else k(new S("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+
" found."));else k(new S("first argument "+a+" is invalid."));return h};
x.pb=function(a,b,c){var d=C(a)?a:G(a)?a.name:m;C(d)||k(new S("store name "+d+" must be a string, but "+typeof d));var e=X(this.c,d);e?this.c.F()&&G(a)&&(a=Jd(a),(a=Ud(e,a))&&k(new $d(a))):(this.c.F()||k(new S('store name "'+d+'" not found.')),e=Jd(G(a)?a:{name:d}),K(this.b,"Adding object store: "+d),Fg(this.h,e));a=oc();var f=this;e||k(new S('store name "'+d+'" not found.'));C(e.keyPath)&&z(c)&&k(new S("key cannot provide while in-line key is in used."));e.autoIncrement&&z(c)&&k(new S("key cannot provide while autoIncrement is true."));
!C(e.keyPath)&&(!e.autoIncrement&&!z(c))&&k(new S("out-of-line key must be provided."));if(A(b))K(this.b,"addObjects: "+d+" "+b.length+" objects"),this.a.i(a,function(a,e,g){$(f).ub(a,e,g,d,b,c)},[d],Q),e.da&&a.U(function(a){gd(f.h,new Gg(Hg,f.h,e.getName(),a,b))});else if(G(b)){var g="store: "+d+" key: "+!!e.keyPath?Rd(e,b):c;K(this.b,"addObject: "+g);this.a.i(a,function(a,e,g){$(f).tb(a,e,g,d,b,c)},[d],Q);e.da&&a.U(function(a){gd(f.h,new Ig(Hg,f.h,e.getName(),a,b))})}else k(new S("record must be an object or array list of objects, but "+
b+" of type "+typeof b+" found."));return a};function Jg(a,b){var c=C(b)?b:G(b)?b.name:m;C(c)||k(new S("store name must be a string"));var d=X(a.c,c);if(d){if(a.c.F()&&G(b)){var e=Jd(b);(e=Ud(d,e))&&k(new $d(e))}}else a.c.F()||k(new ze(c)),d=Jd(G(b)?b:{name:c}),K(a.b,"Adding object store: "+c),Fg(a.h,d);d||k(new ze(c));return d}
x.za=function(a,b,c){var d=oc(),e=this;if(a instanceof kd){var d=a.a,f=X(this.c,d);f||k(new S('store "'+d+'" not found.'));if(f.keyPath){var g=Rd(f,b);g!=r?0!=V(g,a.id)&&k(new S("Inline key must be "+a+" but "+g+" found.")):Sd(f,b,a.id);return this.za(d,b)}return this.za(d,b,a.id)}if(A(a)){z(c)&&k(new S("too many arguments"));z(b)||k(new S("record values required"));for(var f=[],g=0,h=a.length;g<h;g++){var l=a[g].a;-1==Ia(f,l)&&f.push(l);var n=X(this.c,l);n||k(new S('store "'+l+'" not found.'));n.keyPath&&
Sd(n,b[g],a[g].id)}K(this.b,"putByKeys: to "+W(f)+" "+b.length+" objects");this.a.i(d,function(c,d,f){$(e).Ib(c,d,f,b,a)},f,Q)}else if(C(a)||G(a)){var n=Jg(this,a),q=n.getName();n.keyPath&&z(c)&&k(new S("key cannot provide while in-line key is in used."));n.autoIncrement&&z(c)&&k(new S("key cannot provide while autoIncrement is true."));!n.keyPath&&(!n.autoIncrement&&!z(c))&&k(new S("out-of-line key must be provided."));A(b)?(K(this.b,"putObjects: "+q+" "+b.length+" objects"),this.a.i(d,function(a,
d,f){$(e).Kb(a,d,f,q,b,c)},[q],Q),n.da&&d.U(function(a){gd(e.h,new Gg(Kg,e.h,q,a,b))})):G(b)?(K(this.b,"putObject: "+q+" "+c),this.a.i(d,function(a,d,f){$(e).Jb(a,d,f,q,b,c)},[q],Q),n.da&&d.U(function(a){gd(e.h,new Ig(Kg,e.h,q,a,b))})):k(new S("put record value must be Object or array of Objects"))}else k(new S("the first argument of put must be store name, store schema or array of keys."));return d};
x.clear=function(a,b,c){z(c)&&k(new S("too many input arguments"));c=oc();var d=this;if(C(a))if(X(this.c,a)||k(new S('store name "'+a+'" not found.')),G(b)){var e=rd(b);e===r&&k(new S("clear method requires a valid non-null KeyRange object."));K(this.b,"clearByKeyRange: "+a+":"+W(e));this.a.i(c,function(b,c,f){$(d).yb(b,c,f,a,e)},[a],Q)}else z(b)&&k(new S("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+typeof b)),K(this.b,"clearByStore: "+a),this.a.i(c,
function(b,c,e){$(d).Va(b,c,e,[a])},[a],Q);else if(!z(a)||A(a)&&C(a[0])){var f=a||Wd(this.c);K(this.b,"clearByStores: "+W(f));this.a.i(c,function(a,b,c){$(d).Va(a,b,c,f)},f,Q)}else k(new S('first argument "'+a+'" is invalid.'));return c};
x.qb=function(a,b,c){var d=oc(),e=this;if(C(a)){var f=X(this.c,a);f||k(new S('store name "'+a+'" not found.'));if(z(c))if(C(b)){var g=Md(f,b);g||k(new S("index: "+b+" not found in "+a));if(G(c)||c===r){var h=rd(c);K(this.b,"removeByIndexKeyRange: "+a+":"+g.getName()+" "+a);this.a.i(d,function(b,c,d){$(e).Lb(b,c,d,a,g.getName(),h)},[a],Q)}else k(new S("key range "+c+' is invalid type "'+typeof c+'".'))}else k(new S('index name "'+b+'" must be a string, but '+typeof b+" found."));else C(b)||F(b)||B(b)||
b instanceof Date?(K(this.b,"removeById: "+a+":"+b),this.a.i(d,function(c,d,f){$(e).ib(c,d,f,a,b)},[a],Q),f.da&&d.U(function(b){gd(e.h,new Ig(Lg,e.h,a,b,m))})):G(b)?(h=rd(b),K(this.b,"removeByKeyRange: "+a+":"+W(h)),this.a.i(d,function(b,c,d){$(e).jb(b,c,d,a,h)},[a],Q),f.da&&d.U(function(b){gd(e.h,new Gg(Lg,e.h,a,b,m))})):k(new S('Invalid key or key range "'+b+'" of type '+typeof b))}else if(a instanceof kd)this.a.i(d,function(b,c,d){$(e).ib(b,c,d,a.a,a.id)},[a.a],Q);else if(A(a)){c=[];for(var f=
0,l=a.length;f<l;f++){a[f]instanceof kd||k(new S("key list element at "+f+" of "+l+' must be yn.db.Key, but "'+ne(a[f])+'" ('+da(a[f])+") is not ydn.db.Key."));var n=a[f].a;-1==Ia(c,n)&&c.push(n)}1>c.length&&k(new S('at least one valid key required in key list "'+ne(a)+'"'));this.a.i(d,function(b,c,d){$(e).Mb(b,c,d,a)},c,Q)}else k(new S('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+ne(a)+'" ('+da(a)+") found."));return d};
x.toString=function(){return"DbOperator:"+this.h.getName()};function Mg(a,b,c){Dg.call(this,a,b,c)}I(Mg,Eg);x=Mg.prototype;x.b=M("ydn.db.core.DbOperator");x.ya=function(a,b){var c=this;if(a instanceof Y){var d=oc(),e=a.S,f=X(this.c,e);f||k(new S('store "'+e+'" not found.'));var g=a.N();z(g)&&!Pd(f,g)&&k(new S('index "'+g+'" not found in store "'+e+'".'));f=new N;f.z(function(a){O(d,a[0])},function(a){d.n(a)});K(this.b,"getByIterator:"+a);this.a.i(f,function(b,d,e){$(c).d(b,d,e,a,1)},[e],P);return d}return Mg.D.ya.call(this,a,b)};
x.keys=function(a,b,c,d,e){var f=this;if(a instanceof Y){d=oc();var g=100;F(b)?(g=b,1>g&&k(new S("limit must be a positive value, but "+b))):z(b)&&k(new S("limit must be a number,  but "+b));z(c)&&k(new S("offset must not be specified"));K(this.b,"keysByIterator:"+a);this.a.i(d,function(b,c,d){$(f).e(b,c,d,a,g)},a.stores(),P);return d}return Mg.D.keys.call(this,a,b,c,d,e)};
x.count=function(a,b,c){var d=this;return a instanceof Y?((z(b)||z(c))&&k(new S("too many arguments.")),b=oc(),K(this.b,"countKeyRange:"+a),this.a.i(b,function(b,c,g){$(d).oa(b,c,g,a.S,a.uc(),a.N(),a.hc())},a.stores(),P),b):Mg.D.count.call(this,a,b,c)};
x.w=function(a,b,c,d,e,f){var g=this;if(a instanceof Y){d=oc();var h;F(b)?(h=b,1>h&&k(new S("limit must be a positive value, but "+h))):z(b)&&k(new S("limit must be a number, but "+b));z(c)&&k(new S("offset must not be specified"));K(this.b,"listByIterator:"+a);this.a.i(d,function(b,c,d){$(g).d(b,c,d,a,h)},a.stores(),P);return d}return Mg.D.w.call(this,a,b,c,d,e,f)};
x.jc=function(a,b){var c=oc();if(z(b)){A(b)||k(new TypeError("Iterator argument must be an array."));for(var d=0;d<b.length;d++)b[d]instanceof Y||k(new TypeError("Iterator at "+d+" must be cursor range iterator."))}var e;e=b?b:r;for(var f=[],d=0;d<e.length;d++)for(var g=e[d].stores(),h=0;h<g.length;h++)0<=Ia(f,g[h])||f.push(g[h]);L(this.b,this+": scan for "+e.length+" iterators on "+f);var l=this;this.a.i(c,function(b,c,d){function f(){for(var a=0,d=0;d<e.length;d++){var t=Mf(e[d],b,c,$(l));t.f=g;
t.e=na(h,a);pa[d]=t;U[a]=d;a++}T=e.length}function g(a){for(var b=0;b<pa.length;b++)Gf(pa[b]);Qa(pa);K(l.b,E+" error");d(a,p)}function h(b,c){ua&&k(new be);Eb++;var f=Eb===T,g=U[b],n=e[g],q=pa[g],g=q.L(),q=q.aa();ea[b]=c;Na[b]=n.e?n.d?g:q:n.d?c:q;if(f){var w;w=a instanceof Vf?a.d(ea,Na):a(ea,Na);f=[];n=[];g=[];q=[];if(A(w))for(var v=0;v<w.length;v++)w[v]===p?g[v]=1:w[v]===s?q[v]=p:n[v]=w[v];else if(w===r)f=[];else if(z(w))if(G(w)){f=["advance","continue","continuePrimary","restart"];for(v in w)0<=
Ia(f,v)||k(new xd('Unknown attribute "'+v+'" in cursor advancement object'));f=w.continuePrimary||[];n=w["continue"]||[];g=w.advance||[];q=w.restart||[]}else k(new de("scan callback output"));else{f=[];for(v=0;v<e.length;v++)z(U[v])&&(g[v]=1)}for(v=Eb=w=0;v<e.length;v++)f[v]==r&&(!z(n[v])&&q[v]==r&&g[v]==r)&&Eb++;for(v=0;v<e.length;v++)if(f[v]!=r||z(n[v])||q[v]!=r||g[v]!=r){var D=U[v];z(D)||k(new de(v+" is not an iterator."));var D=e[D],Gb=pa[v];if(ea[v]==r){var Se=v+"/"+e.length;g[v]!=r&&k(new ee(Gb+
" "+Se+" must not advance "+g[v]+" steps"));z(n[v])&&k(new ee(Gb+" "+Se+" must not continue to key "+n[v]));f[v]!=r&&k(new ee(Gb+" "+Se+" must not continue to primary key "+f[v]))}ea[v]=m;Na[v]=m;q[v]!=r?(D=Gb,D.G=s,D.a[0].Ua(m,m)):z(n[v])?Gb.a[0].la(n[v]):f[v]!=r?Gb.a[0].Ta(f[v]):g[v]!=r?Gb.advance(1):k(new be(D+": has no action"));w++}if(0==w){for(f=0;f<pa.length;f++)Gf(pa[f]);ua=p;Qa(pa);K(l.b,"success "+E);d(m)}}}var E=c+" "+l+" scanning";L(l.b,E);var ua=s,T,U=[],ea=[],Na=[],pa=[],Eb=0;a instanceof
Vf?a.c(e,function(){f()})||f():f()},f,P);return c};
x.ic=function(a,b,c){b instanceof Y||k(new S("Second argument must be cursor range iterator."));X(this.c,b.S)||k(new S('Store "'+b.S+'" not found.'));c=c||P;var d=this,e=oc();K(this.b,"open:"+c+" "+b);this.a.i(e,function(c,e,h){L(d.b,e+" iterating "+b);var l=Mf(b,c,e,$(d));l.f=function(a){h(a,p)};l.e=function(b){if(b!=r){var c=a(l);c===p?(l.G=s,l.a[0].Ua(m,m)):G(c)?c.restart===p?(b=c["continue"],c=c.continuePrimary,l.G=s,l.a[0].Ua(c,b)):c["continue"]!=r?l.a[0].la(c["continue"]):c.continuePrimary!=
r?l.a[0].Ta(c.continuePrimary):(Gf(l),h(m)):l.advance(1)}else Gf(l),h(m)}},b.stores(),c);return e};x.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)e||k(new S('Store "'+e+'" not found.'));e=oc();L(this.b,"map:"+a);this.a.i(e,function(d,e,f){L(c.b,e+" iterating "+a);var n=Mf(a,d,e,$(c));n.f=function(a){f(a,s)};n.e=function(c){c!=r?(b(a.e?a.d?c:n.L():a.d?c:n.aa()),n.advance(1)):(f(m),b=r)}},d,P);return e};
x.nb=function(a,b,c){for(var d=this,e=a.stores(),f,g=0;f=e[g];g++)f||k(new S('Store "'+f+'" not found.'));f=oc();var h=G(c)?me(W(c)):c;K(this.b,"reduce:"+a);this.a.i(f,function(c,e,f){var g=Mf(a,c,e,$(d));g.f=function(a){f(a,p)};var w=0;g.e=function(c){c!=r?(h=b(h,a.e?a.d?c:g.L():a.d?c:g.aa(),w++),g.advance(1)):f(h)}},e,P);return f};var Hg="created",Lg="deleted",Kg="updated";function Ng(a,b){Jc.call(this,a,b)}I(Ng,Jc);Ng.prototype.f=u("d");function Og(a,b,c,d,e){Jc.call(this,a,b);this.version=c;this.kc=d;this.error=e}I(Og,Ng);x=Og.prototype;x.name="StorageEvent";x.version=NaN;x.kc=NaN;x.error=r;x.Sc=u("version");x.sc=u("kc");x.Rc=u("error");function Ig(a,b,c,d,e){Jc.call(this,a,b);this.d=c;this.key=d;this.value=e}I(Ig,Ng);Ig.prototype.name="RecordEvent";Ig.prototype.g=u("key");Ig.prototype.j=u("value");
function Gg(a,b,c,d,e){Jc.call(this,a,b);this.d=c;this.keys=d;this.w=e}I(Gg,Ng);Gg.prototype.name="StoreEvent";Gg.prototype.ea=u("keys");Gg.prototype.ab=u("w");function Ge(a,b){Vd.call(this,a,b)}I(Ge,Vd);Ge.prototype.F=ba(p);function re(a,b){a.stores.push(b)};function Hd(a,b){var c;c=c||{};if(a==r||b==r)return s;if(A(a)&&A(b)){if(a.length!=b.length)return s;for(var d=0;d<a.length;d++)if(-1==Oa(b,function(b){return Hd(b,a[d])}))return s;return p}if(A(a))return 1==a.length&&Hd(a[0],b);if(A(b))return 1==b.length&&Hd(b[0],a);if(G(a)&&G(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=Hd(a[e],b[e]);if(!f)return s}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=Hd(a[e],b[e]),!f))return s;return p}return a===b}
function ug(a){for(var b in a)if(a.hasOwnProperty(b))return a[b]};function Pg(){};function Qg(){}I(Qg,Pg);Qg.prototype.Ca=function(){var a=0;cb(this.ma(p),function(){a++});return a};Qg.prototype.clear=function(){var a=db(this.ma(p)),b=this;Ja(a,function(a){b.v.removeAttribute(Rg(a));Sg(b)})};function Tg(a,b){if(pb&&!(pb&&9<=Cb)){Ug||(Ug=new eb);var c=Ug;this.v=Object.prototype.hasOwnProperty.call(c.c,a)?c.c[a]:m;this.v||(b?this.v=document.getElementById(b):(this.v=document.createElement("userdata"),this.v.addBehavior("#default#userData"),document.body.appendChild(this.v)),fb(Ug,a,this.v));this.Ob=a;try{this.v.load(this.Ob)}catch(d){this.v=r}}}I(Tg,Qg);var Vg={".":".2E","!":".21","~":".7E","*":".2A","'":".27","(":".28",")":".29","%":"."},Ug=r;x=Tg.prototype;x.v=r;x.Ob=r;
function Rg(a){return"_"+encodeURIComponent(a).replace(/[.!~*'()%]/g,function(a){return Vg[a]})}x.Ca=function(){return Wg(this).attributes.length};x.ma=function(a){var b=0,c=Wg(this).attributes,d=new ab;d.a=function(){b>=c.length&&k($a);var d=c[b++];if(a)return decodeURIComponent(d.nodeName.replace(/\./g,"%")).substr(1);d=d.nodeValue;C(d)||k("Storage mechanism: Invalid value was encountered");return d};return d};
x.clear=function(){for(var a=Wg(this),b=a.attributes.length;0<b;b--)a.removeAttribute(a.attributes[b-1].nodeName);Sg(this)};function Sg(a){try{a.v.save(a.Ob)}catch(b){k("Storage mechanism: Quota exceeded")}}function Wg(a){return a.v.XMLDocument.documentElement};function Xg(){vf.call(this,this)}I(Xg,vf);Xg.prototype.Wa=function(a){return new Yg(a)};Xg.prototype.ka=ba("userdata");function Yg(a){this.h=new Tg(a);this.length=this.keys().length}x=Yg.prototype;x.length=0;x.clear=function(){this.h.clear();this.a=[]};x.keys=function(){this.a||(this.a=[],cb(this.h,function(a){this.a.push(a)},this));return this.a};x.key=function(a){return this.keys()[a]};x.setItem=function(a,b){this.a&&this.a.push(a);var c=this.h;c.v.setAttribute(Rg(a),b);Sg(c)};
x.getItem=function(a){a=this.h.v.getAttribute(Rg(a));!C(a)&&a!==r&&k("Storage mechanism: Invalid value was encountered");return z(a)?a:r};x.removeItem=function(a){this.a=r;var b=this.h;b.v.removeAttribute(Rg(a));Sg(b)};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Z(a,b,c){fd.call(this);c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial".split(" "),e;for(e in c)c.hasOwnProperty(e)&&-1==Ia(d,e)&&k(new S('Unknown attribute "'+e+'" in options.'));if(c.mechanisms){A(c.mechanisms)||k(new S("mechanisms attribute must be an array but "+da(c.mechanisms)+" found."));for(e=0;e<c.mechanisms.length;e++)0<=Ia(Zg,c.mechanisms[e])||k(new S('Invalid mechanism "'+c.mechanisms[e]+'"'))}this.wc=c.mechanisms||Zg;this.bc=c.size;this.xc=z(c.connectionTimeout)?
c.connectionTimeout:3E4;this.fc=z(c.fc)?c.fc:s;this.a=r;this.j=[];this.fb=s;if(b instanceof Vd)c=b;else if(G(b)){c=c.autoSchema||!z(b.stores)?new Ge(b):new Vd(b);d=d=b.stores?b.stores.length:0;for(e=0;e<d;e++){var f=X(c,b.stores[e].name);b.stores[e].Sync&&J(this.b,"Synchronization option for "+f.getName()+" ignored.")}}else c=new Ge;this.c=c;z(a)&&this.r(a)}I(Z,fd);Z.prototype.b=M("ydn.db.con.Storage");
Z.prototype.yc=function(a){if(z(a)){var b=function(b){a(b.toJSON())};if(this.a)this.a.J(b);else{var c=this;this.transaction(function(a){c.a.J(b,a)},r,P)}}return this.c?this.c.toJSON():r};function Fg(a,b){var c=b instanceof Id?b:Jd(b),d=b.name,e=X(a.c,d);0==Ud(c,e).length?mc(s):(e=e?"update":"add",a.c instanceof Ge?(re(a.c,c),a.a?(a.a.lb(),a.a=r,$g(a)):mc(s)):k(new ce("Cannot "+e+" store: "+d+". Not auto schema generation mode.")))}
Z.prototype.r=function(a){this.a&&k(Error("Already defined with "+this.e));this.e=a;$g(this)};H("ydn.db.con.Storage.prototype.setName",Z.prototype.r);Z.prototype.getName=u("e");var Zg="indexeddb websql localstorage sessionstorage userdata memory".split(" ");function ah(a,b){return"indexeddb"==b?new oe(a.bc,a.xc):"websql"==b?new Ee(a.bc):"localstorage"==b?new xf:"sessionstorage"==b?new zf:"memory"==b?new vf:"userdata"==b?new Xg:r}
function $g(a){function b(b,d){b?(L(a.b,a+": ready."),a.Oc=NaN,id(function(){a.onReady(d);bh(a)}),O(c,d)):(J(a.b,a+": database connection fail "+d.name),id(function(){a.onReady(d);if(a.j){a.b.log(Qb,"Purging "+a.j.length+" transactions request.",m);for(var b;b=a.j.shift();)b.C&&b.C("error",d)}}),c.n(d))}for(var c=new N,d=r,e=a.wc,f=0;f<e.length;f++){var g=e[f].toLowerCase();if("indexeddb"==g&&qe){d=ah(a,g);break}else if("websql"==g&&ga(y.openDatabase)){d=ah(a,g);break}else if("localstorage"==g&&window.localStorage){d=
ah(a,g);break}else if("sessionstorage"==g&&window.sessionStorage){d=ah(a,g);break}else if("memory"==g){d=ah(a,g);break}else if("userdata"==g){d=ah(a,g);break}}d===r?(e=new ce("No storage mechanism found."),b(s,new Og("ready",a,NaN,NaN,e))):d.wa(a.e,a.c).z(function(a){this.a=d;b(p,new Og("ready",this,parseFloat(d.mb()),parseFloat(a),r));d.e=function(){L(this.b,this+": disconnected.")}},function(a){J(this.b,this+": opening fail: "+a.message);var c=new Og("ready",this,NaN,NaN,a);c.message=a.message;
b(s,c)},a)}Z.prototype.g=function(){if(this.a)return this.a.ka()};H("ydn.db.con.Storage.prototype.getType",Z.prototype.g);Z.prototype.onReady=function(a){gd(this,a)};Z.prototype.ua=function(){this.a&&(this.a.lb(),this.a=r,L(this.b,this+" closed"))};H("ydn.db.con.Storage.prototype.close",Z.prototype.ua);x=Z.prototype;x.Nc=function(){return this.a?this.a.Rb():r};x.Oc=NaN;function bh(a){var b=a.j.shift();b&&(L(a.b,"pop tx queue "+b.pa.name),a.transaction(b.pa,b.Bc,b.mode,b.C));oa()}
function ch(a,b,c,d,e){L(a.b,"push tx queue "+b.name);a.j.push({pa:b,Bc:c,mode:d,C:e});100<a.j.length&&0==a.j.length%100&&J(a.b,"Transaction queue stack size is "+a.j.length+". It is too large, possibility due to incorrect usage.")}x.fb=s;
x.transaction=function(a,b,c,d){var e=b;if(C(b))e=[b];else if(b!=r)if(B(b)){0==b.length&&k(new S("number of store names must more than 0"));for(var f=0;f<b.length;f++)C(b[f])||k(new S("store name at "+f+" must be string but found "+typeof b[f]))}else k(new S("store names must be an array"));else e=r;if(!this.a||!this.a.Sa()||this.fb)ch(this,a,e,c,d);else{var g=this,h=z(c)?c:P;h==rc&&(this.fb=p);this.a.Za(function(b){a(b);a=r},e,h,function(a,b){ga(d)&&(d(a,b),d=m);h==rc&&(g.fb=s);bh(g)})}};
x.Ab=function(a,b,c,d){function e(a){0<=Ia(["created","ready","deleted","updated"],a)||k(new S('Invalid event type "'+a+'"'))}if(B(a))for(var f=0;f<a.length;f++)e(a[f]);else e(a);Z.D.Ab.call(this,a,b,c,d)};x.toString=function(){return"Storage:"+this.a};function dh(a,b,c,d){this.d=a;this.f=b;this.a=Sa(c);this.c=d;this.e=[]}dh.prototype.d=r;dh.prototype.fa=u("f");function eh(a,b,c){a.d?(b(a.d),c&&a.e.push(c)):k(new yd("tx committed on ParallelTxExecutor"))}dh.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.f+" mode:"+this.c+" scopes:"+W(this.a)};function fh(a,b,c,d,e,f){this.h=a;this.f=b;this.c=this.Aa=0;this.La=this.Z=r;this.e=d;this.d=e;this.a=c||"single";this.rb=f||0}x=fh.prototype;x.Aa=0;x.rb=0;x.Z=r;x.La=r;x.b=M("ydn.db.tr.Parallel");x.fa=u("Aa");x.type=function(){return this.h.g()};x.abort=function(){K(this.b,this+": aborting");xg(this.La)};
x.oc=function(a,b){var c;if("multi"==this.a)a:if(c=this.Z,!c.a||!c.c||b!=c.c&&(c.c!=Q||b!=P)||a.length>c.a.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=s;break a}c=p}else if("repeat"==this.a)a:if(c=this.Z,!c.a||!c.c||b!=c.c||c.a.length!=a.length)c=s;else{for(d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=s;break a}c=p}else c="all"==this.a?p:s;return c};
x.Na=function(a,b,c,d){function e(c){l.Aa++;n=new dh(c,l.Aa,b,h);g=gh(l);Zb(l.b,g+" BEGIN "+W(b)+" "+h);l.Z=n;eh(l.Z,a,d)}function f(a,b){"complete"==a?Zb(l.b,g+" COMMITTED"):Zb(l.b,g+" COMMITTED with "+a);for(var c=n,d;d=c.e.shift();)d(a,b);c.d=r;c.a=r;c.e=r}var g;this.e&&(b=this.e);this.d&&(c=this.d);var h=z(c)?c:P,l=this,n;this.Z&&this.Z.d&&this.oc(b,h)?eh(this.Z,a,d):(this.rb&&this.Aa>=this.rb&&k(new xd("Exceed maximum number of transactions of "+this.rb)),this.h.transaction(e,b,h,f))};
x.i=function(a,b,c,d,e){var f=this,g;this.Na(function(c){f.c++;g=gh(f)+"R"+f.c;K(f.b,g+" BEGIN");b(c,gh(f),function(b,d){f.La=c;g=gh(f)+"R"+f.c;d?(K(f.b,g+" ERROR"),a.n(b)):(K(f.b,g+" SUCCESS"),O(a,b));f.La=r});b=r;K(f.b,g+" END")},c,d,e)};function gh(a){return"B"+a.f+"T"+a.Aa}x.toString=function(){return"Parallel:"+this.a+":"+gh(this)+(this.La?"*":"")};function hh(a,b){fh.call(this,a,b,"single")}I(hh,fh);hh.prototype.oc=ba(s);hh.prototype.i=function(a,b,c,d,e){var f,g,h=new N;h.z(function(a){g=s;f=a},function(a){g=p;f=a});hh.D.i.call(this,h,b,c,d,function(b,c){if(g===p)a.n(f);else if(g===s)O(a,f);else{var d=new se;a.n(d)}e&&(e(b,c),e=m)})};function ih(a,b){yg.call(this,a,b)}I(ih,yg);ih.prototype.Tb=function(a,b){var c;a:if(c=this.q,!c.I||!c.mode||b!=c.mode&&(c.mode!=Q||b!=P)||a.length>c.I.length)c=s;else{for(var d=0;d<a.length;d++)if(-1==c.I.indexOf(a[d])){c=s;break a}c=p}return c};function jh(a,b){yg.call(this,a,b)}I(jh,yg);jh.prototype.b=M("ydn.db.tr.StrictOverflowSerial");jh.prototype.Tb=function(a,b){return kh(this.q,a,b)};jh.prototype.$b=function(){var a=this.q;return!!a&&kh(a,0<this.a.length?this.a[0].I:r,0<this.a.length?this.a[0].mode:r)};function zg(a){this.e=a;this.a=r;this.c=0}zg.prototype.b=M("ydn.db.tr.Mutex");zg.prototype.I=r;function kh(a,b,c){if(!a.I||!a.mode||c!=a.mode||a.I.length!=b.length)return s;for(c=0;c<b.length;c++)if(-1==a.I.indexOf(b[c]))return s;return p}zg.prototype.C=r;function Bg(a){return"B"+a.e+"T"+a.c}zg.prototype.toString=function(){return"Mutex:"+Bg(this)+(this.a?"*":"")};function lh(a,b,c){Z.call(this,a,b,c);this.$=0;a=p;b="single";c&&(z(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));this.d=this.Ub(b,a)}I(lh,Z);x=lh.prototype;x.$=0;x.Ub=function(a,b,c,d,e){var f;"readonly"==d?f=P:"readwrite"==d&&(f=Q);a=mh(this,a,b,c,f,e);return this.Ja(a,r)};x.fa=function(){return this.d?this.d.fa():NaN};x.Ja=function(a){return new Dg(this,this.c,a)};
function mh(a,b,c,d,e,f){if(c){if("multi"==b)return new ih(a,a.$++);if("repeat"==b)return new jh(a,a.$++);if("atomic"==b)return new Cg(a,a.$++);if("single"==b)return new yg(a,a.$++,f);k(new S('Invalid requestType "'+b+'"'))}if("multi"==b||"repeat"==b||"all"==b||"single"==b)return new fh(a,a.$++,b,d,e,f);if("atomic"==b)return new hh(a,a.$++);k(new S('Invalid requestType "'+b+'"'))}x.abort=function(){this.d.abort()};
x.Ac=function(a,b,c,d,e){var f=this;this.$++;var g=P;c&&("readwrite"==c?g=Q:"readonly"!=c&&k(new S('Invalid transaction mode "'+c+'"')));var h=mh(this,"all",s,b,g,1),l=this.Ja(h,r);b!=r||(b=Wd(this.c));if(B(b)){0==b.length&&k(new S("number of store names must more than 0"));for(var n=0;n<b.length;n++)C(b[n])||k(new S("store name at "+n+" must be string but found "+typeof b[n]))}else k(new S("store names must be an array"));var q=a;if(4<arguments.length)var t=Array.prototype.slice.call(arguments,4),
q=function(){var b=Array.prototype.slice.call(arguments),b=b.concat(t);return a.apply(this,b)};L(this.b,"scheduling run in transaction with "+h);h.Na(function(){L(f.b,"executing run in transaction on "+h);q(l);q=r},b,g,d)};function nh(a,b,c){lh.call(this,a,b,c)}I(nh,lh);x=nh.prototype;x.Ja=function(a){return new Eg(this,this.c,a)};x.Gb=function(){var a=this.g();if("indexeddb"==a)return new Yf(this.e,this.c);if("websql"==a)return new qg(this.e,this.c);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new fg(this.e,this.c);k(new xe("No executor for "+a))};x.pb=function(a,b,c){return this.d.pb(a,b,c)};x.count=function(a,b,c,d){return this.d.count(a,b,c,d)};
x.ya=function(a,b){return this.d.ya(a,b)};x.keys=function(a,b,c,d,e,f){return this.d.keys(a,b,c,d,e,f)};x.w=function(a,b,c,d,e,f){return this.d.w(a,b,c,d,e,f)};x.za=function(a,b,c){return this.d.za(a,b,c)};x.clear=function(a,b,c){return this.d.clear(a,b,c)};x.qb=function(a,b,c){return this.d.qb(a,b,c)};x.toString=function(){var a="Storage:"+this.getName();this.a&&this.a.Sa()&&(a+=" ["+this.g()+"]");return a};function oh(a,b,c){lh.call(this,a,b,c)}I(oh,nh);x=oh.prototype;x.Gb=function(){var a=this.g();if("indexeddb"==a)return new $f(this.e,this.c);if("websql"==a)return new vg(this.e,this.c);if("memory"==a||"userdata"==a||"localstorage"==a||"sessionstorage"==a)return new ig(this.e,this.c);k(new xe("No executor for "+a))};x.Ja=function(a){return new Mg(this,this.c,a)};x.Pc=function(a,b,c){return this.d.ic(a,b,c)};x.Qc=function(a,b){return this.d.jc(a,b)};x.map=function(a,b){return this.d.map(a,b)};
x.nb=function(a,b,c){return this.d.nb(a,b,c)};function ph(a){this.a=a}ph.prototype.a=[];
ph.prototype.c=function(a,b){for(var c=[],d=0;d<this.a.length;d++){var e=this.a[d],f="'"===e[0]&&"'"===e[e.length-1];if('"'===e[0]&&'"'===e[e.length-1])e=Xa(a,Ba(e,'"').split(".")),c.push(e);else if(f)c.push(Ba(e,"'"));else if(C(e))if("true"===e)c.push(p);else if("false"===e)c.push(s);else if("Date"===e)c.push(new Date(parseInt(c.pop(),10)));else if("now"===e)c.push(new Date);else if("!"===e)c[c.length-1]=!c[c.length-1];else if("=="===e)c.push(c.pop()==c.pop());else if("==="===e)c.push(c.pop()===
c.pop());else if("!="===e)c.push(c.pop()!=c.pop());else if("!=="===e)c.push(c.pop()!==c.pop());else if("<="===e)c.push(c.pop()<=c.pop());else if("<"===e)c.push(c.pop()<c.pop());else if(">="===e)c.push(c.pop()>=c.pop());else if(">"===e)c.push(c.pop()>c.pop());else if("&"===e)c.push(c.pop()&c.pop());else if("|"===e)c.push(c.pop()|c.pop());else if("?"===e){var e=!!c.pop(),f=c.pop(),g=c.pop(),e=e?f:g;c.push(e)}else"+"===e?c.push(c.pop()+c.pop()):"-"===e?c.push(c.pop()-c.pop()):"*"===e?c.push(c.pop()*
c.pop()):"/"===e?c.push(c.pop()/c.pop()):"%"===e?c.push(c.pop()%c.pop()):"at"===e?(f=c.pop(),e=c.pop(),c.push(e[f])):"of"===e?(f=c.pop(),e=c.pop(),e=A(e)?e.indexOf(f):-1,c.push(e)):"in"===e?(f=c.pop(),e=c.pop(),e=A(e)?0<=e.indexOf(f):s,c.push(e)):"abs"===e?c[c.length-1]=Math.abs(c[c.length-1]):"$"==e[0]&&/^\$\d$/.test(e)?(e=parseInt(e.match(/^\$(\d)$/)[1],10),c.push(arguments[e])):c.push(parseFloat(e));else c.push(e)}return c[0]};
ph.prototype.d=function(){return function(){var a=2<arguments.length?Array.prototype.slice(arguments,2):m;return ph.prototype.c.apply(r,a)}};ph.prototype.toJSON=function(){return{Tokens:me(W(this.a))}};function qh(a){C(a)||k(new Zd);this.H=a;rh(this,a);this.Pa=""}x=qh.prototype;x.H="";x.Qa=P;x.ac=NaN;x.dc=NaN;x.Pb=s;x.Pa="";
function rh(a,b){var c=b.split(/\sFROM\s/i);2!=c.length&&k(new De("FROM required."));var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);3!=c.length&&k(new De("Unable to parse: "+b));a.d=c[1].toUpperCase();"SELECT"==a.d?a.Qa=P:"INSERT"==a.d?a.Qa=Q:"UPDATE"==a.d?a.Qa=Q:"DELETE"==a.d?a.Qa=Q:k(new De("Unknown SQL verb: "+a.d));var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.e=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.e=m;"("==c.charAt(0)&&
(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-1):new De("missing closing parentheses"));a.k=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.a=d.substring(c),d=d.substring(0,c)):a.a="";c=d.search(/WHERE/i);0<c?(a.f=d.substring(c+6).trim(),d=d.substring(0,c)):a.f="";a.c=d.trim().split(",").map(function(a){a=Ba(a,'"');a=Ba(a,"'");return a.trim()})}function sh(a){if("*"==a.k)return r;a=a.k.split(",");return a=a.map(function(a){return Ba(a.trim(),'"')})}x.toJSON=function(){return{sql:this.H}};
function th(a){function b(a){return Pa(c,function(b){return b.T==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.f.length)for(var e=a.f.split("AND"),f=0;f<e.length;f++){var g=e[f],h=d.exec(g);if(h){var l=h[1].trim(),l=Ba(l,'"'),l=Ba(l,"'");if(0<l.length){var n=h[3].trim(),n=0==n.lastIndexOf('"',0)?Ba(n,'"'):0==n.lastIndexOf("'",0)?Ba(n,"'"):parseFloat(n),h=new Hf(l,h[2],n),l=b(l);if(0<=l){if(c[l]=c[l].vb(h),!c[l])return a.Pa='where clause "'+g+'" conflict',r}else c.push(h)}else return a.Pa='Invalid clause "'+
g+'"',r}else return a.Pa='Invalid clause "'+g+'"',r}return c}x.toString=function(){return"query:"+this.H};function uh(a,b){this.sql=b;this.a=a}uh.prototype.b=M("ydn.db.sql.req.idb.Node");uh.prototype.toJSON=function(){return{sql:this.sql}};uh.prototype.toString=ba("idb.Node:");
uh.prototype.mc=function(a,b,c,d){var e=Sa(this.sql.c)[0],f=this.sql.g,g=this.sql.ac,g=isNaN(g)?100:g,h=this.sql.dc,h=isNaN(h)?0:h,l=this.sql.j,n=sh(this.sql),q=r,t=this.sql.Pb;0==f.length?q=r:1==f.length?q=rd(f[0].a):k(new $d("too many conditions."));var w=c;n===r||(w=function(a,b){if(b)c(a,p);else{var d=a.map(function(a){var b=n.length;if(1==b)return tc(a,n[0]);for(var c={},d=0;d<b;d++)c[n[d]]=tc(a,n[d]);return c});c(d)}});l&&l!=this.a.keyPath?d.Ha(a,b,w,e,l,q,t,g,h,s):0<f.length&&f[0].T!=this.a.keyPath?
d.Ha(a,b,w,e,f[0].T,q,t,g,h,s):d.Ia(a,b,w,e,q,t,g,h)};function vh(a,b){uh.call(this,a,b)}I(vh,uh);
vh.prototype.mc=function(a,b,c,d){var e,f=Sa(this.sql.c)[0],g=this.sql.g,h=r;0==g.length?h=r:1==g.length?h=rd(g[0].a):k(new $d("too many conditions."));var l=this.sql.e;if("COUNT"==l)h?d.oa(a,b,c,f,h,g[0].T,s):d.oa(a,b,c,f,r,m,s);else{var n,q=sh(this.sql);(!q||0==q.length)&&k(new ee("field name require for reduce operation: "+l));q=q[0];"MIN"==l?n=wh(q):"MAX"==l?n=xh(q):"AVG"==l?(e=0,n=yh(q)):"SUM"==l?(e=0,n=zh(q)):k(new $d(l));var t;t=h?new Lf(f,g[0].T,h):new Kf(f);var w=Mf(t,a,b,d);w.f=function(a){c(a,
p)};var v=0;w.e=function(a){z(a)?(e=n(t.d?w.L():w.aa(),e,v),w.advance(1),v++):c(e)}}};function yh(a){return function(b,c,d){z(c)||(c=0);return(c*d+b[a])/(d+1)}}function zh(a){return function(b,c){return c+b[a]}}function wh(a){return function(b,c){var d=b[a];return!z(c)?d:c<d?c:d}}function xh(a){return function(b,c){var d=b[a];return!z(c)?d:c>d?c:d}};function Ah(a,b){Nf.call(this,a,b)}I(Ah,$f);Ah.prototype.b=M("ydn.db.sql.req.IndexedDb");
Ah.prototype.executeSql=function(a,b,c,d,e){if(e){for(var f=0;f<e.length;f++)d.H=d.H.replace("?",e[f]);rh(d,d.H)}d.g=th(d);if(d.g){e=d.a.length;if(f=/OFFSET\s+(\d+)/i.exec(d.a))d.dc=parseInt(f[1],10),e=d.a.search(/OFFSET/i);if(f=/LIMIT\s+(\d+)/i.exec(d.a))d.ac=parseInt(f[1],10),f=d.a.search(/LIMIT/i),f<e&&(e=f);(e=/ORDER BY\s+(.+)/i.exec(d.a.substr(0,e)))?(e=e[1].trim(),(f=e.match(/(ASC|DESC)/i))?(d.Pb="DESC"==f[0].toUpperCase(),e=e.replace(/\s+(ASC|DESC)/i,"")):d.Pb=s,d.j=Ba(Ba(e,'"'),"'")):d.j=
m;e=""}else e=d.Pa;e&&k(new De(e));e=Sa(d.c);if(1==e.length){(f=X(this.a,e[0]))||k(new ze(e[0]));var g=sh(d);if(g)for(var h=0;h<g.length;h++)Pd(f,g[h])||k(new ze('Index "'+g[h]+'" not found in '+e[0]));(d.e?new vh(f,d):new uh(f,d)).mc(a,b,c,this)}else k(new $d(d.H))};function Bh(a,b){this.sql=b;this.c=a;this.a=sh(b)}Bh.prototype.b=M("ydn.db.sql.req.websql.Node");Bh.prototype.toJSON=function(){return{sql:this.sql.H}};Bh.prototype.toString=ba("websql.Node:");function Ch(a,b){if(a.a){if(1==a.a.length){if(G(b))return Xa(b,a.a[0]);return}for(var c={},d=0;d<a.a.length;d++)c[a.a[d]]=Xa(b,a.a[d]);return c}return lg(b,a.c)}
Bh.prototype.nc=function(a,b,c){var d=this,e=[];b.executeSql(this.sql.H,c,function(b,c){for(var h=c.rows.length,l=0;l<h;l++){var n=c.rows.item(l);if(G(n))var q=Ch(d,n);e.push(q)}a(e)},function(b,c){J(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function Dh(a,b){Bh.call(this,a,b)}I(Dh,Bh);Dh.prototype.nc=function(a,b,c){var d=this;b.executeSql(this.sql.H,c,function(b,c){var d=c.rows.length;1==d?(d=ug(c.rows.item(0)),a(d)):0==d?a(m):k(new xe)},function(b,c){J(d.b,"Sqlite error: "+c.message);a(c,p);return p})};function Eh(a,b){Nf.call(this,a,b)}I(Eh,vg);Eh.prototype.b=M("ydn.db.sql.req.WebSql");Eh.prototype.executeSql=function(a,b,c,d,e){b=Sa(d.c);if(1==b.length){var f=X(this.a,b[0]);f||k(new ze(b[0]));var g=sh(d);if(g)for(var h=0;h<g.length;h++)Pd(f,g[h])||k(new ze('Index "'+g[h]+'" not found in '+b[0]));(d.e?new Dh(f,d):new Bh(f,d)).nc(c,a,e)}else k(new $d(d.H))};function Fh(a,b){Nf.call(this,a,b)}I(Fh,ig);Fh.prototype.executeSql=function(){k("not yet")};function Gh(a,b,c){Dg.call(this,a,b,c)}I(Gh,Mg);Gh.prototype.executeSql=function(a,b){for(var c=oc(),d=new qh(a),e=Sa(d.c),f=0;f<e.length;f++){var g=X(this.c,e[f]);g||k(new S("store: "+g+" not exists."))}var h=this;K(this.b,"executeSql: "+a+" params: "+b);this.a.i(c,function(a,c,e){$(h).executeSql(a,c,e,d,b||[])},Sa(d.c),d.Qa);return c};function Hh(a,b,c){lh.call(this,a,b,c)}I(Hh,oh);Hh.prototype.Gb=function(){var a=this.g();if("indexeddb"==a)return new Ah(this.e,this.c);if("websql"==a)return new Eh(this.e,this.c);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new Fh(this.e,this.c);k(new xe("No executor for "+a))};Hh.prototype.Ja=function(a){return new Gh(this,this.c,a)};Hh.prototype.executeSql=function(a,b){return this.d.executeSql(a,b)};function Ih(a,b,c){lh.call(this,a,b,c)}I(Ih,Hh);function Jh(a,b){Vf.call(this,a,b)}I(Jh,Vf);Jh.prototype.c=ba(s);Jh.prototype.d=function(a,b){function c(b){z(a[b])?(e=s,d[b]=p):(d[b]=s,0<=b-1&&c(b-1))}var d=[],e=p;c(a.length-1);e&&(d=[]);return Wf(this,d,b)};function Kh(a,b){Vf.call(this,a,b);this.e=a instanceof Sf&&!!a.va}I(Kh,Vf);Kh.prototype.b=M("ydn.db.algo.ZigzagMerge");Kh.prototype.e=s;Kh.prototype.c=function(a,b){var c=Kh.D.c.call(this,a,b);if(this.e){var d=a[0].N().split(", ");1<d.length?d[d.length-1]!=this.a.va&&k(new ee("Output streamer projection field must be same as postfix field in the iterator")):J(this.b,"Unable to check correctness of output streamer.")}return c};
Kh.prototype.d=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}var d=[];if(0==a.length||a[0]==r||a[0]==r)return[];for(var e=p,f=0,g=a[f][a[f].length-1],h=[],l=1;l<a.length;l++)if(a[l]!=r){var n=a[l][a[l].length-1],q=V(g,n);h[l]=q;1===q?e=s:-1===q&&(e=s,g=n,f=1)}else return[];if(e){for(e=0;e<a.length;e++)a[e]!=r&&(d[e]=p);this.a&&(this.e?this.a.push(b[0],g):this.a.push(b[0]));return d}if(0==f)for(e=1;e<a.length;e++)1===h[e]&&(d[e]=c(a[e],g));else for(e=0;e<a.length;e++)e!=
f&&a[e]!=r&&1===V(g,a[e][a[e].length-1])&&(d[e]=c(a[e],g));return{"continue":d}};function Lh(a,b){Vf.call(this,a,b)}I(Lh,Vf);Lh.prototype.c=ba(s);Lh.prototype.d=function(a,b){var c=[],d=b[0];if(d==r)return[];for(var e=p,f=s,g=d,h=[],l=1;l<a.length;l++)if(b[l]!=r){var n=V(d,b[l]);h[l]=n;1===n?e=s:-1===n&&(e=s,f=p,1===V(b[l],g)&&(g=b[l]))}else e=s,f=p;if(e)for(f=0;f<a.length;f++)b[f]!=r&&(c[f]=p);else if(f)for(f=0;f<a.length;f++)b[f]!=r&&1===V(g,b[f])&&(c[f]=g);else for(f=1;f<a.length;f++)1===h[f]&&(c[f]=d);return e?(this.f++,this.a&&this.a.push(g),c):{continuePrimary:c}};H("ydn.db.Storage",Ih);H("ydn.db.algo.NestedLoop",Jh);H("ydn.db.algo.ZigzagMerge",Kh);H("ydn.db.algo.SortedMerge",Lh);N.prototype.done=N.prototype.U;N.prototype.fail=N.prototype.Vb;N.prototype.then=N.prototype.z;N.prototype.always=N.prototype.pc;fd.prototype.addEventListener=fd.prototype.Ab;H("ydn.db.con.Storage",Z);Z.prototype.getType=Z.prototype.g;Z.prototype.setName=Z.prototype.r;Z.prototype.getName=Z.prototype.getName;Z.prototype.getSchema=Z.prototype.yc;Z.prototype.transaction=Z.prototype.transaction;Z.prototype.close=Z.prototype.ua;H("ydn.db.version","0.6.1");H("ydn.db.deleteDatabase",function(a,b){qe&&((!b||"indexeddb"==b)&&qe&&"deleteDatabase"in qe)&&qe.deleteDatabase(a);ga(y.openDatabase)&&(!b||"websql"==b)&&Ie(a);(!b||"localstorage"==b)&&yf(a);(!b||"sessionstorage"==b)&&Af(a)});
Og.prototype.name=Og.prototype.name;Og.prototype.getVersion=Og.prototype.Sc;Og.prototype.getOldVersion=Og.prototype.sc;Og.prototype.getError=Og.prototype.Rc;lh.prototype.branch=lh.prototype.Ub;lh.prototype.run=lh.prototype.Ac;Dg.prototype.abort=Dg.prototype.abort;lh.prototype.abort=lh.prototype.abort;nh.prototype.branch=nh.prototype.Ub;nh.prototype.add=nh.prototype.pb;nh.prototype.get=nh.prototype.ya;nh.prototype.values=nh.prototype.w;nh.prototype.put=nh.prototype.za;nh.prototype.clear=nh.prototype.clear;nh.prototype.remove=nh.prototype.qb;nh.prototype.count=nh.prototype.count;Eg.prototype.add=Eg.prototype.pb;Eg.prototype.get=Eg.prototype.ya;Eg.prototype.values=Eg.prototype.w;Eg.prototype.put=Eg.prototype.za;Eg.prototype.clear=Eg.prototype.clear;Eg.prototype.remove=Eg.prototype.qb;
Eg.prototype.count=Eg.prototype.count;H("ydn.db.cmp",V);H("ydn.db.Key",kd);kd.prototype.id=kd.prototype.rc;kd.prototype.parent=kd.prototype.Kc;kd.prototype.storeName=kd.prototype.Lc;H("ydn.db.KeyRange",R);R.upperBound=od;R.lowerBound=pd;R.bound=nd;R.only=function(a){return new R(a,a,s,s)};R.starts=qd;Ng.prototype.store_name=Ng.prototype.d;Ng.prototype.getStoreName=Ng.prototype.f;Ig.prototype.name=Ig.prototype.name;Ig.prototype.getKey=Ig.prototype.g;Ig.prototype.getValue=Ig.prototype.j;
Gg.prototype.name=Gg.prototype.name;Gg.prototype.getKeys=Gg.prototype.ea;Gg.prototype.getValues=Gg.prototype.ab;oh.prototype.scan=oh.prototype.Qc;oh.prototype.map=oh.prototype.map;oh.prototype.reduce=oh.prototype.nb;oh.prototype.open=oh.prototype.Pc;Mg.prototype.scan=Mg.prototype.jc;Mg.prototype.map=Mg.prototype.map;Mg.prototype.reduce=Mg.prototype.nb;Mg.prototype.open=Mg.prototype.ic;Bf.prototype.getKey=Bf.prototype.gc;Bf.prototype.getPrimaryKey=Bf.prototype.L;Bf.prototype.getValue=Bf.prototype.aa;Bf.prototype.update=Bf.prototype.update;Bf.prototype.clear=Bf.prototype.clear;H("ydn.math.Expression",ph);
ph.prototype.evaluate=ph.prototype.c;ph.prototype.compile=ph.prototype.d;ph.parseRpn=function(a){return new ph(a.match(/[^\s"']+|"[^"]*"|'[^']*'/g))};ph.parseInfix=function(){k(new ae("Too lazy to learn Dutch in Shunting Yard station, we speak Polish here."))};H("ydn.db.Iterator",Y);H("ydn.db.KeyCursors",If);H("ydn.db.ValueCursors",Kf);H("ydn.db.Cursors",Jf);H("ydn.db.IndexValueCursors",Lf);Y.prototype.count=Y.prototype.count;Y.prototype.getState=Y.prototype.Zb;Y.prototype.getKeyRange=Y.prototype.Ec;
Y.prototype.getIndexName=Y.prototype.N;Y.prototype.getStoreName=Y.prototype.Gc;Y.prototype.isReversed=Y.prototype.Ic;Y.prototype.isUnique=Y.prototype.hc;Y.prototype.isKeyIterator=Y.prototype.Hc;Y.prototype.isIndexIterator=Y.prototype.tc;Y.prototype.getPrimaryKey=Y.prototype.Fc;Y.prototype.getKey=Y.prototype.Dc;Y.prototype.resume=Y.prototype.zc;Y.prototype.reset=Y.prototype.Jc;If.where=function(a,b,c,d,e){return new If(a,wd(b,c,d,e))};Kf.where=function(a,b,c,d,e){return new Kf(a,wd(b,c,d,e))};
Jf.where=function(a,b,c,d,e,f){return new Jf(a,b,wd(c,d,e,f))};Lf.where=function(a,b,c,d,e,f){return new Lf(a,b,wd(c,d,e,f))};H("ydn.db.Streamer",Sf);Sf.prototype.push=Sf.prototype.push;Sf.prototype.collect=Sf.prototype.Mc;Sf.prototype.setSink=Sf.prototype.Cc;var Mh=new function(){this.a=oa()};function Nh(a){this.e=a||"";this.f=Mh}Nh.prototype.a=p;Nh.prototype.c=s;function Oh(a){a=new Date(a.g);return Ph(a.getFullYear()-2E3)+Ph(a.getMonth()+1)+Ph(a.getDate())+" "+Ph(a.getHours())+":"+Ph(a.getMinutes())+":"+Ph(a.getSeconds())+"."+Ph(Math.floor(a.getMilliseconds()/10))}function Ph(a){return 10>a?"0"+a:String(a)}function Sh(a,b){var c=(a.g-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function Th(a){Nh.call(this,a)}I(Th,Nh);Th.prototype.c=p;
Th.prototype.d=function(a){var b;switch(a.f.value){case Nb.value:b="dbg-sh";break;case Ob.value:b="dbg-sev";break;case Pb.value:b="dbg-w";break;case Qb.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.e," ");this.a&&c.push("[",Oh(a),"] ");c.push("[",Aa(Sh(a,this.f.a)),"s] ");c.push("[",ta(a.d),"] ");c.push('<span class="',b,'">',sa(Aa(ta(a.e))));this.c&&a.c&&c.push("<br>",sa(Aa(a.a||"")));c.push("</span><br>");return c.join("")};function Uh(a){Nh.call(this,a)}I(Uh,Nh);
Uh.prototype.d=function(a){var b=[];b.push(this.e," ");this.a&&b.push("[",Oh(a),"] ");b.push("[",Sh(a,this.f.a),"s] ");b.push("[",a.d,"] ");b.push(a.e,"\n");this.c&&a.c&&b.push(a.a,"\n");return b.join("")};function Vh(){this.f=ma(this.g,this);this.a=new Uh;this.a.a=s;this.c=this.a.c=s;this.d="";this.e={}}Vh.prototype.g=function(a){if(!this.e[a.d]){var b=this.a.d(a),c=Wh;if(c)switch(a.f){case Nb:Xh(c,"info",b);break;case Ob:Xh(c,"error",b);break;case Pb:Xh(c,"warn",b);break;default:Xh(c,"debug",b)}else window.opera?window.opera.postError(b):this.d+=b}};var Wh=window.console;function Xh(a,b,c){if(a[b])a[b](c);else a.log(c)};var Yh,Zh=!pb||pb&&9<=Cb;!qb&&!pb||pb&&pb&&9<=Cb||qb&&Ab("1.9.1");pb&&Ab("9");function $h(a,b){var c;c=a.className;c=C(c)&&c.match(/\S+/g)||[];for(var d=Ta(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Ia(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};function ai(a,b){Wa(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in bi?a.setAttribute(bi[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var bi={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function ci(a,b,c){function d(c){c&&b.appendChild(C(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];B(f)&&!(G(f)&&0<f.nodeType)?Ja(di(f)?Sa(f):f,d):d(f)}}function di(a){if(a&&"number"==typeof a.length){if(G(a))return"function"==typeof a.item||"string"==typeof a.item;if(ga(a))return"function"==typeof a.item}return s}function ei(a){this.a=a||y.document||document}
function fi(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
ei.prototype.c=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!Zh&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',ta(g.name),'"');if(g.type){f.push(' type="',ta(g.type),'"');var h={};Za(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=d.createElement(f);g&&(C(g)?f.className=g:A(g)?$h.apply(r,[f].concat(g)):ai(f,g));2<e.length&&ci(d,f,e);return f};
ei.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function gi(a){this.f=ma(this.g,this);this.c=new Th;this.d=this.c.a=s;this.a=a;this.e=this.a.ownerDocument||this.a.document;var b=(a=this.a)?new ei(9==a.nodeType?a:a.ownerDocument||a.document):Yh||(Yh=new ei),c=r;pb?(a=c=b.a.createStyleSheet(),pb?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"):(a=fi(b,"head")[0],a||(c=fi(b,"body")[0],a=b.c("head"),c.parentNode.insertBefore(a,c)),b=c=b.c("style"),pb?b.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
b.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}",a.appendChild(c));this.a.className+=" logdiv"}
gi.prototype.g=function(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.e.createElement("div");c.className="logmsg";c.innerHTML=this.c.d(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)};gi.prototype.clear=function(){this.a.innerHTML=""};var hi=r,ii=r;M("ydn.debug");H("ydn.debug.log",function(a,b,c){if(F(b))b=new Mb("log",b);else if(C(b)){b=b.toUpperCase();if(!Wb){Wb={};for(var d=0,e;e=Vb[d];d++)Wb[e.value]=e,Wb[e.name]=e}b=Wb[b]||r}else b=Sb;M(a||"ydn").c=b;z(c)?ii||(a=ii=new gi(c),p!=a.d&&(c=dc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.d=p),dc().c=Pb):!hi&&!ii&&(a=hi=new Vh,p!=a.c&&(c=dc(),b=a.f,c.a||(c.a=[]),c.a.push(b),a.c=p),dc().c=Pb)});Z.prototype.db=Z.prototype.Nc;})();

            //@ sourceMappingURL=zty-ydn.db-dev.js.map
        

            })(jQuery);
        